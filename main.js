/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TextSorterPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  showFloatingBar: true,
  barLeft: 20,
  barTop: 80,
  targetFilePath: null
};
var TextSorterPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.activeTargetHeading = null;
  }
  async onload() {
    await this.loadSettings();
    this.floatingBar = new SortingFloatingBar(this);
    this.addCommand({
      id: "toggle-sorter-bar",
      name: "Show/Hide sorting bar",
      callback: () => {
        const newState = !this.settings.showFloatingBar;
        this.floatingBar.toggle(newState);
        new import_obsidian.Notice(newState ? "Sorting bar shown" : "Sorting bar hidden");
      }
    });
    this.registerEvent(this.app.workspace.on("active-leaf-change", () => {
      this.floatingBar.refreshHeadings();
    }));
    this.registerEvent(this.app.metadataCache.on("changed", (file) => {
      const activeFile = this.app.workspace.getActiveFile();
      if (activeFile === file || this.settings.targetFilePath === file.path) {
        this.floatingBar.refreshHeadings();
      }
    }));
    this.registerEvent(this.app.vault.on("rename", (file, oldPath) => {
      if (this.settings.targetFilePath === oldPath) {
        this.settings.targetFilePath = file.path;
        this.saveSettings();
        this.floatingBar.refreshHeadings();
      }
    }));
    this.registerEvent(this.app.vault.on("delete", (file) => {
      if (this.settings.targetFilePath === file.path) {
        this.settings.targetFilePath = null;
        this.saveSettings();
        this.floatingBar.refreshHeadings();
      }
    }));
    this.app.workspace.onLayoutReady(() => {
      if (this.settings.showFloatingBar) {
        this.floatingBar.toggle(true, false);
      }
    });
  }
  async onunload() {
    this.floatingBar.clearUI();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  // --- Core Logic ---
  getHeadings(file) {
    if (!file || file.extension !== "md")
      return [];
    const cache = this.app.metadataCache.getFileCache(file);
    return (cache == null ? void 0 : cache.headings) || [];
  }
  // Used by Clipboard Button
  async sendClipboardToHeading(targetHeadingName) {
    const text = await navigator.clipboard.readText();
    if (!text || text.trim() === "") {
      new import_obsidian.Notice("Clipboard is empty.");
      return;
    }
    await this.transferTextOnly(targetHeadingName, text);
  }
  // Used by Move (Arrow) Button
  async moveParagraphToHeadingName(editor, view, targetHeadingName) {
    const cursor = editor.getCursor();
    const sourceLineNum = cursor.line;
    const textToMove = editor.getLine(sourceLineNum);
    if (!textToMove || !textToMove.trim()) {
      new import_obsidian.Notice("Current line is empty.");
      return;
    }
    let targetFile = null;
    if (this.settings.targetFilePath) {
      const abstractFile = this.app.vault.getAbstractFileByPath(this.settings.targetFilePath);
      if (abstractFile instanceof import_obsidian.TFile)
        targetFile = abstractFile;
    }
    if (!targetFile)
      targetFile = this.app.workspace.getActiveFile();
    const activeFile = this.app.workspace.getActiveFile();
    const isSameFile = activeFile === targetFile;
    if (isSameFile) {
      this.moveTextWithinCurrentEditor(editor, sourceLineNum, targetHeadingName, textToMove);
    } else {
      if (targetFile) {
        const success = await this.insertIntoBackgroundFile(targetFile, targetHeadingName, textToMove);
        if (success) {
          editor.replaceRange(
            "",
            { line: sourceLineNum, ch: 0 },
            { line: sourceLineNum + 1, ch: 0 }
          );
          this.fixCursorAfterDelete(editor, sourceLineNum);
        }
      } else {
        new import_obsidian.Notice("Target file not found.");
      }
    }
  }
  // --- Helper: Move text inside the SAME active editor ---
  moveTextWithinCurrentEditor(editor, sourceLine, headingName, text) {
    const file = this.app.workspace.getActiveFile();
    const headings = this.getHeadings(file);
    const targetHeading = headings.find((h) => h.heading === headingName);
    if (!targetHeading) {
      new import_obsidian.Notice(`Heading "${headingName}" not found.`);
      return;
    }
    const targetIndex = headings.indexOf(targetHeading);
    let insertLineIndex = -1;
    if (targetIndex === headings.length - 1) {
      insertLineIndex = editor.lineCount();
    } else {
      const nextHeading = headings[targetIndex + 1];
      insertLineIndex = nextHeading.position.start.line;
    }
    if (insertLineIndex <= sourceLine) {
      editor.replaceRange(text + "\n", { line: insertLineIndex, ch: 0 });
      const adjustedSourceLine = sourceLine + 1;
      editor.replaceRange(
        "",
        { line: adjustedSourceLine, ch: 0 },
        { line: adjustedSourceLine + 1, ch: 0 }
      );
      editor.setCursor(insertLineIndex, 0);
    } else {
      editor.replaceRange(text + "\n", { line: insertLineIndex, ch: 0 });
      editor.replaceRange(
        "",
        { line: sourceLine, ch: 0 },
        { line: sourceLine + 1, ch: 0 }
      );
      this.fixCursorAfterDelete(editor, sourceLine);
    }
    new import_obsidian.Notice(`Moved to "${headingName}"`);
  }
  // --- Helper: Insert text (Clipboard or Cross-file) ---
  async transferTextOnly(targetHeadingName, content) {
    let targetFile = null;
    if (this.settings.targetFilePath) {
      const abstractFile = this.app.vault.getAbstractFileByPath(this.settings.targetFilePath);
      if (abstractFile instanceof import_obsidian.TFile)
        targetFile = abstractFile;
    }
    if (!targetFile) {
      targetFile = this.app.workspace.getActiveFile();
    }
    if (!targetFile) {
      new import_obsidian.Notice("No target file identified.");
      return false;
    }
    if (targetFile.extension !== "md") {
      new import_obsidian.Notice("Target must be a Markdown file.");
      return false;
    }
    const activeFile = this.app.workspace.getActiveFile();
    const isSameFile = activeFile === targetFile;
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (isSameFile && activeView) {
      return this.pasteIntoEditor(activeView.editor, targetHeadingName, content);
    }
    return this.insertIntoBackgroundFile(targetFile, targetHeadingName, content);
  }
  // Simple paste, no deletions calculated
  pasteIntoEditor(editor, headingName, text) {
    const file = this.app.workspace.getActiveFile();
    const headings = this.getHeadings(file);
    const targetHeading = headings.find((h) => h.heading === headingName);
    if (!targetHeading) {
      new import_obsidian.Notice(`Heading "${headingName}" not found.`);
      return false;
    }
    const targetIndex = headings.indexOf(targetHeading);
    let insertLineIndex = -1;
    if (targetIndex === headings.length - 1) {
      insertLineIndex = editor.lineCount();
    } else {
      const nextHeading = headings[targetIndex + 1];
      insertLineIndex = nextHeading.position.start.line;
    }
    const insertPos = { line: insertLineIndex, ch: 0 };
    if (insertLineIndex >= editor.lineCount()) {
      editor.replaceRange("\n" + text, { line: editor.lineCount(), ch: 0 });
    } else {
      editor.replaceRange(text + "\n", insertPos);
    }
    new import_obsidian.Notice(`Pasted to "${headingName}"`);
    return true;
  }
  async insertIntoBackgroundFile(file, headingName, text) {
    const fileContent = await this.app.vault.read(file);
    const headings = this.getHeadings(file);
    const targetHeading = headings.find((h) => h.heading === headingName);
    if (!targetHeading) {
      new import_obsidian.Notice(`Heading "${headingName}" not found in target.`);
      return false;
    }
    const lines = fileContent.split("\n");
    const targetIndex = headings.indexOf(targetHeading);
    let insertLine = lines.length;
    if (targetIndex < headings.length - 1) {
      const nextHeading = headings[targetIndex + 1];
      insertLine = nextHeading.position.start.line;
    }
    lines.splice(insertLine, 0, text);
    await this.app.vault.modify(file, lines.join("\n"));
    new import_obsidian.Notice(`Sent to "${file.basename}"`);
    return true;
  }
  fixCursorAfterDelete(editor, deletedLine) {
    const maxLines = editor.lineCount();
    if (deletedLine >= maxLines) {
      editor.setCursor(maxLines - 1, 0);
    } else {
      editor.setCursor(deletedLine, 0);
    }
  }
};
var SortingFloatingBar = class {
  constructor(plugin) {
    this.container = null;
    this.dropdown = null;
    this.targetNameDisplay = null;
    this.plugin = plugin;
    this.app = plugin.app;
  }
  clearUI() {
    if (this.container) {
      this.container.remove();
      this.container = null;
    }
    this.dropdown = null;
  }
  async toggle(show, save = true) {
    this.clearUI();
    if (show) {
      this.createUI();
      setTimeout(() => this.refreshHeadings(), 50);
    }
    if (save) {
      this.plugin.settings.showFloatingBar = show;
      await this.plugin.saveSettings();
    }
  }
  refreshHeadings() {
    if (!this.dropdown || !this.targetNameDisplay)
      return;
    let targetFile = null;
    let isLocked = false;
    if (this.plugin.settings.targetFilePath) {
      const f = this.app.vault.getAbstractFileByPath(this.plugin.settings.targetFilePath);
      if (f instanceof import_obsidian.TFile) {
        targetFile = f;
        isLocked = true;
      }
    }
    if (!targetFile) {
      targetFile = this.app.workspace.getActiveFile();
    }
    if (targetFile) {
      this.targetNameDisplay.setText(isLocked ? `\u{1F512} ${targetFile.basename}` : `\u{1F4C4} ${targetFile.basename}`);
      this.targetNameDisplay.style.color = isLocked ? "var(--text-accent)" : "var(--text-muted)";
    } else {
      this.targetNameDisplay.setText("No File");
    }
    this.dropdown.empty();
    if (!targetFile || targetFile.extension !== "md") {
      this.dropdown.createEl("option", { text: "(Need .md file)", value: "" });
      this.plugin.activeTargetHeading = null;
      return;
    }
    const headings = this.plugin.getHeadings(targetFile);
    if (headings.length === 0) {
      this.dropdown.createEl("option", { text: "No Headings", value: "" });
      this.plugin.activeTargetHeading = null;
      return;
    }
    headings.forEach((h) => {
      const indent = "\xA0".repeat((h.level - 1) * 2);
      this.dropdown.createEl("option", {
        text: `${indent}# ${h.heading}`,
        value: h.heading
      });
    });
    const currentSelection = this.plugin.activeTargetHeading;
    if (currentSelection && headings.some((h) => h.heading === currentSelection)) {
      this.dropdown.value = currentSelection;
    } else {
      this.dropdown.selectedIndex = 0;
      this.plugin.activeTargetHeading = this.dropdown.value;
    }
  }
  createUI() {
    this.container = document.body.createDiv({ cls: "sorter-floating-bar" });
    this.container.style.cssText = `
            position: fixed; 
            z-index: 15; 
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border); 
            border-radius: 6px;
            padding: 4px 8px; 
            box-shadow: var(--shadow-s); 
            display: flex; 
            gap: 6px; 
            align-items: center;
            width: auto;
            max-width: 90vw;
            cursor: move; 
            font-size: 0.8em;
            user-select: none;
        `;
    this.applyInitialPosition(this.container);
    this.setupContainerStylesAndDrag(this.container);
    const lockBtn = this.container.createEl("button", {
      text: "\u{1F3AF}",
      attr: {
        style: "padding: 2px 6px; background: transparent; border: 1px solid var(--background-modifier-border); flex-shrink: 0;"
      }
    });
    lockBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      const activeFile = this.app.workspace.getActiveFile();
      if (this.plugin.settings.targetFilePath) {
        this.plugin.settings.targetFilePath = null;
        new import_obsidian.Notice("Target unlocked");
      } else if (activeFile && activeFile.extension === "md") {
        this.plugin.settings.targetFilePath = activeFile.path;
        new import_obsidian.Notice(`Locked: ${activeFile.basename}`);
      } else {
        new import_obsidian.Notice("Select a Markdown file to lock.");
      }
      this.plugin.saveSettings();
      this.refreshHeadings();
    });
    this.targetNameDisplay = this.container.createSpan({
      text: "...",
      attr: { style: "font-weight: bold; max-width: 80px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; display: inline-block;" }
    });
    this.dropdown = this.container.createEl("select", {
      cls: "sorter-dropdown",
      attr: { style: "flex: 1; min-width: 60px; max-width: 150px;" }
    });
    this.dropdown.addEventListener("change", () => {
      if (this.dropdown)
        this.plugin.activeTargetHeading = this.dropdown.value;
    });
    this.dropdown.addEventListener("touchstart", (e) => e.stopPropagation(), { passive: true });
    this.dropdown.addEventListener("mousedown", (e) => e.stopPropagation());
    const sendBtn = this.container.createEl("button", {
      text: "\u27A4",
      attr: {
        style: "padding: 2px 8px; background: var(--interactive-accent); color: var(--text-on-accent); border: none; border-radius: 3px; flex-shrink: 0;"
      }
    });
    sendBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      const view = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
      if (view && this.plugin.activeTargetHeading) {
        this.plugin.moveParagraphToHeadingName(view.editor, view, this.plugin.activeTargetHeading);
      } else {
        new import_obsidian.Notice(view ? "No heading selected." : "Open Markdown file.");
      }
    });
    const clipBtn = this.container.createEl("button", {
      text: "\u{1F4CB}",
      attr: {
        style: "padding: 2px 8px; background: var(--background-secondary); border: 1px solid var(--background-modifier-border); border-radius: 3px; flex-shrink: 0;"
      }
    });
    clipBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      if (this.plugin.activeTargetHeading) {
        this.plugin.sendClipboardToHeading(this.plugin.activeTargetHeading);
      } else {
        new import_obsidian.Notice("No target heading.");
      }
    });
    const closeBtn = this.container.createEl("button", {
      text: "\xD7",
      attr: {
        style: "background: transparent; border: none; color: var(--text-muted); font-size: 1.2em; line-height: 1; padding: 0 4px; margin-left: 2px; flex-shrink: 0;"
      }
    });
    closeBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      this.toggle(false);
    });
  }
  applyInitialPosition(container) {
    let left = this.plugin.settings.barLeft;
    let top = this.plugin.settings.barTop;
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;
    if (left > viewportWidth - 50)
      left = viewportWidth - 320;
    if (top > viewportHeight - 50)
      top = viewportHeight - 100;
    if (left < 0)
      left = 10;
    if (top < 0)
      top = 10;
    container.style.left = `${left}px`;
    container.style.top = `${top}px`;
  }
  setupContainerStylesAndDrag(container) {
    let isDragging = false;
    let dragOffset = { x: 0, y: 0 };
    const getEventCoords = (e) => {
      if (e instanceof MouseEvent)
        return { x: e.clientX, y: e.clientY };
      if (e.touches && e.touches.length > 0)
        return { x: e.touches[0].clientX, y: e.touches[0].clientY };
      return null;
    };
    const onDragStart = (e) => {
      if (e.target.closest("select, button"))
        return;
      if (e instanceof MouseEvent && e.button !== 0)
        return;
      const coords = getEventCoords(e);
      if (!coords)
        return;
      isDragging = true;
      const rect = container.getBoundingClientRect();
      dragOffset = { x: coords.x - rect.left, y: coords.y - rect.top };
      container.style.cursor = "grabbing";
      e.preventDefault();
      if (e instanceof MouseEvent) {
        document.addEventListener("mousemove", onDragMove);
        document.addEventListener("mouseup", onDragEnd);
      } else {
        document.addEventListener("touchmove", onDragMove, { passive: false });
        document.addEventListener("touchend", onDragEnd);
      }
    };
    const onDragMove = (e) => {
      if (!isDragging)
        return;
      e.preventDefault();
      const coords = getEventCoords(e);
      if (!coords)
        return;
      const x = coords.x - dragOffset.x;
      const y = coords.y - dragOffset.y;
      container.style.left = `${x}px`;
      container.style.top = `${y}px`;
    };
    const onDragEnd = () => {
      if (!isDragging)
        return;
      isDragging = false;
      container.style.cursor = "move";
      const rect = container.getBoundingClientRect();
      this.plugin.settings.barLeft = rect.left;
      this.plugin.settings.barTop = rect.top;
      this.plugin.saveSettings();
      document.removeEventListener("mousemove", onDragMove);
      document.removeEventListener("mouseup", onDragEnd);
      document.removeEventListener("touchmove", onDragMove);
      document.removeEventListener("touchend", onDragEnd);
    };
    container.addEventListener("mousedown", onDragStart);
    container.addEventListener("touchstart", onDragStart, { passive: false });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgXHJcbiAgICBBcHAsIFxyXG4gICAgRWRpdG9yLCBcclxuICAgIE1hcmtkb3duVmlldywgXHJcbiAgICBQbHVnaW4sIFxyXG4gICAgTm90aWNlLFxyXG4gICAgVEZpbGUsXHJcbiAgICBIZWFkaW5nQ2FjaGVcclxufSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vLyAtLS0gU2V0dGluZ3MgLS0tXHJcbmludGVyZmFjZSBUZXh0U29ydGVyU2V0dGluZ3Mge1xyXG4gICAgc2hvd0Zsb2F0aW5nQmFyOiBib29sZWFuO1xyXG4gICAgYmFyTGVmdDogbnVtYmVyO1xyXG4gICAgYmFyVG9wOiBudW1iZXI7XHJcbiAgICB0YXJnZXRGaWxlUGF0aDogc3RyaW5nIHwgbnVsbDtcclxufVxyXG5cclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogVGV4dFNvcnRlclNldHRpbmdzID0ge1xyXG4gICAgc2hvd0Zsb2F0aW5nQmFyOiB0cnVlLFxyXG4gICAgYmFyTGVmdDogMjAsXHJcbiAgICBiYXJUb3A6IDgwLFxyXG4gICAgdGFyZ2V0RmlsZVBhdGg6IG51bGxcclxufTtcclxuXHJcbi8vIC0tLSBNYWluIFBsdWdpbiAtLS1cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGV4dFNvcnRlclBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgICBzZXR0aW5nczogVGV4dFNvcnRlclNldHRpbmdzO1xyXG4gICAgZmxvYXRpbmdCYXI6IFNvcnRpbmdGbG9hdGluZ0JhcjtcclxuICAgIFxyXG4gICAgYWN0aXZlVGFyZ2V0SGVhZGluZzogc3RyaW5nIHwgbnVsbCA9IG51bGw7IFxyXG5cclxuICAgIGFzeW5jIG9ubG9hZCgpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuICAgICAgICAvLyAxLiBJbml0aWFsaXplIFVJXHJcbiAgICAgICAgdGhpcy5mbG9hdGluZ0JhciA9IG5ldyBTb3J0aW5nRmxvYXRpbmdCYXIodGhpcyk7XHJcblxyXG4gICAgICAgIC8vIDIuIENvbW1hbmQ6IFRvZ2dsZSBCYXJcclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICAgICAgICBpZDogJ3RvZ2dsZS1zb3J0ZXItYmFyJyxcclxuICAgICAgICAgICAgbmFtZTogJ1Nob3cvSGlkZSBzb3J0aW5nIGJhcicsXHJcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdTdGF0ZSA9ICF0aGlzLnNldHRpbmdzLnNob3dGbG9hdGluZ0JhcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmxvYXRpbmdCYXIudG9nZ2xlKG5ld1N0YXRlKTtcclxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UobmV3U3RhdGUgPyBcIlNvcnRpbmcgYmFyIHNob3duXCIgOiBcIlNvcnRpbmcgYmFyIGhpZGRlblwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyAzLiBFdmVudHNcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZmxvYXRpbmdCYXIucmVmcmVzaEhlYWRpbmdzKCk7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdjaGFuZ2VkJywgKGZpbGUpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgICAgIGlmIChhY3RpdmVGaWxlID09PSBmaWxlIHx8IHRoaXMuc2V0dGluZ3MudGFyZ2V0RmlsZVBhdGggPT09IGZpbGUucGF0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mbG9hdGluZ0Jhci5yZWZyZXNoSGVhZGluZ3MoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoZmlsZSwgb2xkUGF0aCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy50YXJnZXRGaWxlUGF0aCA9PT0gb2xkUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy50YXJnZXRGaWxlUGF0aCA9IGZpbGUucGF0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZsb2F0aW5nQmFyLnJlZnJlc2hIZWFkaW5ncygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAudmF1bHQub24oJ2RlbGV0ZScsIChmaWxlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnRhcmdldEZpbGVQYXRoID09PSBmaWxlLnBhdGgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MudGFyZ2V0RmlsZVBhdGggPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmxvYXRpbmdCYXIucmVmcmVzaEhlYWRpbmdzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Muc2hvd0Zsb2F0aW5nQmFyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZsb2F0aW5nQmFyLnRvZ2dsZSh0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbnVubG9hZCgpIHtcclxuICAgICAgICB0aGlzLmZsb2F0aW5nQmFyLmNsZWFyVUkoKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tIENvcmUgTG9naWMgLS0tXHJcbiAgICBnZXRIZWFkaW5ncyhmaWxlOiBURmlsZSB8IG51bGwpOiBIZWFkaW5nQ2FjaGVbXSB7XHJcbiAgICAgICAgaWYgKCFmaWxlIHx8IGZpbGUuZXh0ZW5zaW9uICE9PSAnbWQnKSByZXR1cm4gW107XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICByZXR1cm4gY2FjaGU/LmhlYWRpbmdzIHx8IFtdO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVzZWQgYnkgQ2xpcGJvYXJkIEJ1dHRvblxyXG4gICAgYXN5bmMgc2VuZENsaXBib2FyZFRvSGVhZGluZyh0YXJnZXRIZWFkaW5nTmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQucmVhZFRleHQoKTtcclxuICAgICAgICBpZiAoIXRleHQgfHwgdGV4dC50cmltKCkgPT09IFwiXCIpIHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShcIkNsaXBib2FyZCBpcyBlbXB0eS5cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2xpcGJvYXJkIGlzIGFsd2F5cyBqdXN0IGFuIFwiSW5zZXJ0XCIsIG5vIGRlbGV0aW9uIG5lZWRlZFxyXG4gICAgICAgIGF3YWl0IHRoaXMudHJhbnNmZXJUZXh0T25seSh0YXJnZXRIZWFkaW5nTmFtZSwgdGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXNlZCBieSBNb3ZlIChBcnJvdykgQnV0dG9uXHJcbiAgICBhc3luYyBtb3ZlUGFyYWdyYXBoVG9IZWFkaW5nTmFtZShlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3LCB0YXJnZXRIZWFkaW5nTmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xyXG4gICAgICAgIGNvbnN0IHNvdXJjZUxpbmVOdW0gPSBjdXJzb3IubGluZTtcclxuICAgICAgICBjb25zdCB0ZXh0VG9Nb3ZlID0gZWRpdG9yLmdldExpbmUoc291cmNlTGluZU51bSk7XHJcblxyXG4gICAgICAgIGlmICghdGV4dFRvTW92ZSB8fCAhdGV4dFRvTW92ZS50cmltKCkpIHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShcIkN1cnJlbnQgbGluZSBpcyBlbXB0eS5cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIDEuIERldGVybWluZSBUYXJnZXQgRmlsZVxyXG4gICAgICAgIGxldCB0YXJnZXRGaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnRhcmdldEZpbGVQYXRoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFic3RyYWN0RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0aGlzLnNldHRpbmdzLnRhcmdldEZpbGVQYXRoKTtcclxuICAgICAgICAgICAgaWYgKGFic3RyYWN0RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB0YXJnZXRGaWxlID0gYWJzdHJhY3RGaWxlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRhcmdldEZpbGUpIHRhcmdldEZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG5cclxuICAgICAgICAvLyAyLiBMb2dpYyBTcGxpdDogU2FtZSBGaWxlIHZzIERpZmZlcmVudCBGaWxlXHJcbiAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgY29uc3QgaXNTYW1lRmlsZSA9IGFjdGl2ZUZpbGUgPT09IHRhcmdldEZpbGU7XHJcblxyXG4gICAgICAgIGlmIChpc1NhbWVGaWxlKSB7XHJcbiAgICAgICAgICAgIC8vIEZJWDogSGFuZGxlIGluZGV4IHNoaWZ0aW5nIGludGVybmFsbHlcclxuICAgICAgICAgICAgdGhpcy5tb3ZlVGV4dFdpdGhpbkN1cnJlbnRFZGl0b3IoZWRpdG9yLCBzb3VyY2VMaW5lTnVtLCB0YXJnZXRIZWFkaW5nTmFtZSwgdGV4dFRvTW92ZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gQ3Jvc3MtZmlsZSBtb3ZlXHJcbiAgICAgICAgICAgIGlmICh0YXJnZXRGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgdGhpcy5pbnNlcnRJbnRvQmFja2dyb3VuZEZpbGUodGFyZ2V0RmlsZSwgdGFyZ2V0SGVhZGluZ05hbWUsIHRleHRUb01vdmUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTYWZlIHRvIGRlbGV0ZSBsb2NhbCBsaW5lIGFzIHJlbW90ZSBmaWxlIGRpZG4ndCBzaGlmdCBsb2NhbCBpbmRpY2VzXHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJcIiwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgbGluZTogc291cmNlTGluZU51bSwgY2g6IDAgfSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgbGluZTogc291cmNlTGluZU51bSArIDEsIGNoOiAwIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZml4Q3Vyc29yQWZ0ZXJEZWxldGUoZWRpdG9yLCBzb3VyY2VMaW5lTnVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJUYXJnZXQgZmlsZSBub3QgZm91bmQuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLSBIZWxwZXI6IE1vdmUgdGV4dCBpbnNpZGUgdGhlIFNBTUUgYWN0aXZlIGVkaXRvciAtLS1cclxuICAgIG1vdmVUZXh0V2l0aGluQ3VycmVudEVkaXRvcihlZGl0b3I6IEVkaXRvciwgc291cmNlTGluZTogbnVtYmVyLCBoZWFkaW5nTmFtZTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuICAgICAgICBjb25zdCBoZWFkaW5ncyA9IHRoaXMuZ2V0SGVhZGluZ3MoZmlsZSk7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0SGVhZGluZyA9IGhlYWRpbmdzLmZpbmQoaCA9PiBoLmhlYWRpbmcgPT09IGhlYWRpbmdOYW1lKTtcclxuXHJcbiAgICAgICAgaWYgKCF0YXJnZXRIZWFkaW5nKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEhlYWRpbmcgXCIke2hlYWRpbmdOYW1lfVwiIG5vdCBmb3VuZC5gKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdGFyZ2V0SW5kZXggPSBoZWFkaW5ncy5pbmRleE9mKHRhcmdldEhlYWRpbmcpO1xyXG4gICAgICAgIGxldCBpbnNlcnRMaW5lSW5kZXggPSAtMTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldEluZGV4ID09PSBoZWFkaW5ncy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgIGluc2VydExpbmVJbmRleCA9IGVkaXRvci5saW5lQ291bnQoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBuZXh0SGVhZGluZyA9IGhlYWRpbmdzW3RhcmdldEluZGV4ICsgMV07XHJcbiAgICAgICAgICAgIGluc2VydExpbmVJbmRleCA9IG5leHRIZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBGSVggRk9SIEFORFJPSUQvREVTS1RPUDogQWRqdXN0IGRlbGV0ZSBpbmRleCBiYXNlZCBvbiBpbnNlcnQgcG9zaXRpb25cclxuICAgICAgICBpZiAoaW5zZXJ0TGluZUluZGV4IDw9IHNvdXJjZUxpbmUpIHtcclxuICAgICAgICAgICAgLy8gTU9WSU5HIFVQOiBJbnNlcnQgZmlyc3QsIHdoaWNoIHB1c2hlcyBzb3VyY2UgZG93biBieSAxXHJcbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UodGV4dCArIFwiXFxuXCIsIHsgbGluZTogaW5zZXJ0TGluZUluZGV4LCBjaDogMCB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGFkanVzdGVkU291cmNlTGluZSA9IHNvdXJjZUxpbmUgKyAxO1xyXG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKFxyXG4gICAgICAgICAgICAgICAgXCJcIiwgXHJcbiAgICAgICAgICAgICAgICB7IGxpbmU6IGFkanVzdGVkU291cmNlTGluZSwgY2g6IDAgfSwgXHJcbiAgICAgICAgICAgICAgICB7IGxpbmU6IGFkanVzdGVkU291cmNlTGluZSArIDEsIGNoOiAwIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIE1vdmUgY3Vyc29yIHRvIHRoZSBuZXcgbG9jYXRpb25cclxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcihpbnNlcnRMaW5lSW5kZXgsIDApOyBcclxuICAgICAgICB9IFxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBNT1ZJTkcgRE9XTjogSW5zZXJ0IGFmdGVyLCBzb3VyY2UgaW5kZXggcmVtYWlucyB2YWxpZFxyXG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKHRleHQgKyBcIlxcblwiLCB7IGxpbmU6IGluc2VydExpbmVJbmRleCwgY2g6IDAgfSk7XHJcblxyXG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKFxyXG4gICAgICAgICAgICAgICAgXCJcIiwgXHJcbiAgICAgICAgICAgICAgICB7IGxpbmU6IHNvdXJjZUxpbmUsIGNoOiAwIH0sIFxyXG4gICAgICAgICAgICAgICAgeyBsaW5lOiBzb3VyY2VMaW5lICsgMSwgY2g6IDAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5maXhDdXJzb3JBZnRlckRlbGV0ZShlZGl0b3IsIHNvdXJjZUxpbmUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbmV3IE5vdGljZShgTW92ZWQgdG8gXCIke2hlYWRpbmdOYW1lfVwiYCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gLS0tIEhlbHBlcjogSW5zZXJ0IHRleHQgKENsaXBib2FyZCBvciBDcm9zcy1maWxlKSAtLS1cclxuICAgIGFzeW5jIHRyYW5zZmVyVGV4dE9ubHkodGFyZ2V0SGVhZGluZ05hbWU6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAgICAgbGV0IHRhcmdldEZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MudGFyZ2V0RmlsZVBhdGgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWJzdHJhY3RGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuc2V0dGluZ3MudGFyZ2V0RmlsZVBhdGgpO1xyXG4gICAgICAgICAgICBpZiAoYWJzdHJhY3RGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHRhcmdldEZpbGUgPSBhYnN0cmFjdEZpbGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRhcmdldEZpbGUpIHtcclxuICAgICAgICAgICAgdGFyZ2V0RmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRhcmdldEZpbGUpIHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIHRhcmdldCBmaWxlIGlkZW50aWZpZWQuXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmKHRhcmdldEZpbGUuZXh0ZW5zaW9uICE9PSAnbWQnKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJUYXJnZXQgbXVzdCBiZSBhIE1hcmtkb3duIGZpbGUuXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuICAgICAgICBjb25zdCBpc1NhbWVGaWxlID0gYWN0aXZlRmlsZSA9PT0gdGFyZ2V0RmlsZTtcclxuICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuXHJcbiAgICAgICAgaWYgKGlzU2FtZUZpbGUgJiYgYWN0aXZlVmlldykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXN0ZUludG9FZGl0b3IoYWN0aXZlVmlldy5lZGl0b3IsIHRhcmdldEhlYWRpbmdOYW1lLCBjb250ZW50KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmluc2VydEludG9CYWNrZ3JvdW5kRmlsZSh0YXJnZXRGaWxlLCB0YXJnZXRIZWFkaW5nTmFtZSwgY29udGVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2ltcGxlIHBhc3RlLCBubyBkZWxldGlvbnMgY2FsY3VsYXRlZFxyXG4gICAgcGFzdGVJbnRvRWRpdG9yKGVkaXRvcjogRWRpdG9yLCBoZWFkaW5nTmFtZTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcclxuICAgICAgICBjb25zdCBoZWFkaW5ncyA9IHRoaXMuZ2V0SGVhZGluZ3MoZmlsZSk7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0SGVhZGluZyA9IGhlYWRpbmdzLmZpbmQoaCA9PiBoLmhlYWRpbmcgPT09IGhlYWRpbmdOYW1lKTtcclxuXHJcbiAgICAgICAgaWYgKCF0YXJnZXRIZWFkaW5nKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEhlYWRpbmcgXCIke2hlYWRpbmdOYW1lfVwiIG5vdCBmb3VuZC5gKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdGFyZ2V0SW5kZXggPSBoZWFkaW5ncy5pbmRleE9mKHRhcmdldEhlYWRpbmcpO1xyXG4gICAgICAgIGxldCBpbnNlcnRMaW5lSW5kZXggPSAtMTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldEluZGV4ID09PSBoZWFkaW5ncy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgIGluc2VydExpbmVJbmRleCA9IGVkaXRvci5saW5lQ291bnQoKTsgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgbmV4dEhlYWRpbmcgPSBoZWFkaW5nc1t0YXJnZXRJbmRleCArIDFdO1xyXG4gICAgICAgICAgICBpbnNlcnRMaW5lSW5kZXggPSBuZXh0SGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgaW5zZXJ0UG9zID0geyBsaW5lOiBpbnNlcnRMaW5lSW5kZXgsIGNoOiAwIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGluc2VydExpbmVJbmRleCA+PSBlZGl0b3IubGluZUNvdW50KCkpIHtcclxuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShcIlxcblwiICsgdGV4dCwgeyBsaW5lOiBlZGl0b3IubGluZUNvdW50KCksIGNoOiAwIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UodGV4dCArIFwiXFxuXCIsIGluc2VydFBvcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIG5ldyBOb3RpY2UoYFBhc3RlZCB0byBcIiR7aGVhZGluZ05hbWV9XCJgKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBpbnNlcnRJbnRvQmFja2dyb3VuZEZpbGUoZmlsZTogVEZpbGUsIGhlYWRpbmdOYW1lOiBzdHJpbmcsIHRleHQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuICAgICAgICBjb25zdCBoZWFkaW5ncyA9IHRoaXMuZ2V0SGVhZGluZ3MoZmlsZSk7IFxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHRhcmdldEhlYWRpbmcgPSBoZWFkaW5ncy5maW5kKGggPT4gaC5oZWFkaW5nID09PSBoZWFkaW5nTmFtZSk7XHJcbiAgICAgICAgaWYgKCF0YXJnZXRIZWFkaW5nKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEhlYWRpbmcgXCIke2hlYWRpbmdOYW1lfVwiIG5vdCBmb3VuZCBpbiB0YXJnZXQuYCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGxpbmVzID0gZmlsZUNvbnRlbnQuc3BsaXQoJ1xcbicpO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldEluZGV4ID0gaGVhZGluZ3MuaW5kZXhPZih0YXJnZXRIZWFkaW5nKTtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgaW5zZXJ0TGluZSA9IGxpbmVzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldEluZGV4IDwgaGVhZGluZ3MubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICBjb25zdCBuZXh0SGVhZGluZyA9IGhlYWRpbmdzW3RhcmdldEluZGV4ICsgMV07XHJcbiAgICAgICAgICAgIGluc2VydExpbmUgPSBuZXh0SGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGluZXMuc3BsaWNlKGluc2VydExpbmUsIDAsIHRleHQpO1xyXG5cclxuICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbGluZXMuam9pbignXFxuJykpO1xyXG4gICAgICAgIG5ldyBOb3RpY2UoYFNlbnQgdG8gXCIke2ZpbGUuYmFzZW5hbWV9XCJgKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBmaXhDdXJzb3JBZnRlckRlbGV0ZShlZGl0b3I6IEVkaXRvciwgZGVsZXRlZExpbmU6IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IG1heExpbmVzID0gZWRpdG9yLmxpbmVDb3VudCgpO1xyXG4gICAgICAgIGlmIChkZWxldGVkTGluZSA+PSBtYXhMaW5lcykge1xyXG4gICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcihtYXhMaW5lcyAtIDEsIDApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoZGVsZXRlZExpbmUsIDApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVJIENsYXNzOiBUaGUgRmxvYXRpbmcgQmFyXHJcbiAqL1xyXG5jbGFzcyBTb3J0aW5nRmxvYXRpbmdCYXIge1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IFRleHRTb3J0ZXJQbHVnaW47XHJcbiAgICBwcml2YXRlIGFwcDogQXBwO1xyXG4gICAgcHVibGljIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgZHJvcGRvd246IEhUTUxTZWxlY3RFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIHRhcmdldE5hbWVEaXNwbGF5OiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogVGV4dFNvcnRlclBsdWdpbikge1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuYXBwID0gcGx1Z2luLmFwcDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xlYXJVSSgpIHtcclxuICAgICAgICBpZiAodGhpcy5jb250YWluZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kcm9wZG93biA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGFzeW5jIHRvZ2dsZShzaG93OiBib29sZWFuLCBzYXZlOiBib29sZWFuID0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuY2xlYXJVSSgpO1xyXG4gICAgICAgIGlmIChzaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVUkoKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLnJlZnJlc2hIZWFkaW5ncygpLCA1MCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzYXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dGbG9hdGluZ0JhciA9IHNob3c7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVmcmVzaEhlYWRpbmdzKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5kcm9wZG93biB8fCAhdGhpcy50YXJnZXROYW1lRGlzcGxheSkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQgdGFyZ2V0RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcclxuICAgICAgICBsZXQgaXNMb2NrZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnRhcmdldEZpbGVQYXRoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGYgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFyZ2V0RmlsZVBhdGgpO1xyXG4gICAgICAgICAgICBpZiAoZiBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXRGaWxlID0gZjtcclxuICAgICAgICAgICAgICAgIGlzTG9ja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0YXJnZXRGaWxlKSB7XHJcbiAgICAgICAgICAgIHRhcmdldEZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRhcmdldEZpbGUpIHtcclxuICAgICAgICAgICAgdGhpcy50YXJnZXROYW1lRGlzcGxheS5zZXRUZXh0KGlzTG9ja2VkID8gYFx1RDgzRFx1REQxMiAke3RhcmdldEZpbGUuYmFzZW5hbWV9YCA6IGBcdUQ4M0RcdURDQzQgJHt0YXJnZXRGaWxlLmJhc2VuYW1lfWApO1xyXG4gICAgICAgICAgICB0aGlzLnRhcmdldE5hbWVEaXNwbGF5LnN0eWxlLmNvbG9yID0gaXNMb2NrZWQgPyAndmFyKC0tdGV4dC1hY2NlbnQpJyA6ICd2YXIoLS10ZXh0LW11dGVkKSc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy50YXJnZXROYW1lRGlzcGxheS5zZXRUZXh0KFwiTm8gRmlsZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZHJvcGRvd24uZW1wdHkoKTtcclxuXHJcbiAgICAgICAgaWYgKCF0YXJnZXRGaWxlIHx8IHRhcmdldEZpbGUuZXh0ZW5zaW9uICE9PSAnbWQnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZHJvcGRvd24uY3JlYXRlRWwoJ29wdGlvbicsIHsgdGV4dDogJyhOZWVkIC5tZCBmaWxlKScsIHZhbHVlOiAnJyB9KTtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYWN0aXZlVGFyZ2V0SGVhZGluZyA9IG51bGw7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGhlYWRpbmdzID0gdGhpcy5wbHVnaW4uZ2V0SGVhZGluZ3ModGFyZ2V0RmlsZSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGhlYWRpbmdzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmRyb3Bkb3duLmNyZWF0ZUVsKCdvcHRpb24nLCB7IHRleHQ6ICdObyBIZWFkaW5ncycsIHZhbHVlOiAnJyB9KTtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYWN0aXZlVGFyZ2V0SGVhZGluZyA9IG51bGw7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGhlYWRpbmdzLmZvckVhY2goaCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGluZGVudCA9IFwiXFx1MDBBMFwiLnJlcGVhdCgoaC5sZXZlbCAtIDEpICogMik7XHJcbiAgICAgICAgICAgIHRoaXMuZHJvcGRvd24hLmNyZWF0ZUVsKCdvcHRpb24nLCB7IFxyXG4gICAgICAgICAgICAgICAgdGV4dDogYCR7aW5kZW50fSMgJHtoLmhlYWRpbmd9YCwgXHJcbiAgICAgICAgICAgICAgICB2YWx1ZTogaC5oZWFkaW5nIFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgY3VycmVudFNlbGVjdGlvbiA9IHRoaXMucGx1Z2luLmFjdGl2ZVRhcmdldEhlYWRpbmc7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRTZWxlY3Rpb24gJiYgaGVhZGluZ3Muc29tZShoID0+IGguaGVhZGluZyA9PT0gY3VycmVudFNlbGVjdGlvbikpIHtcclxuICAgICAgICAgICAgdGhpcy5kcm9wZG93bi52YWx1ZSA9IGN1cnJlbnRTZWxlY3Rpb247XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5kcm9wZG93bi5zZWxlY3RlZEluZGV4ID0gMDtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYWN0aXZlVGFyZ2V0SGVhZGluZyA9IHRoaXMuZHJvcGRvd24udmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY3JlYXRlVUkoKSB7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZURpdih7IGNsczogJ3NvcnRlci1mbG9hdGluZy1iYXInIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYFxyXG4gICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7IFxyXG4gICAgICAgICAgICB6LWluZGV4OiAxNTsgXHJcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XHJcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTsgXHJcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcclxuICAgICAgICAgICAgcGFkZGluZzogNHB4IDhweDsgXHJcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zKTsgXHJcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7IFxyXG4gICAgICAgICAgICBnYXA6IDZweDsgXHJcbiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICAgICAgICAgIHdpZHRoOiBhdXRvO1xyXG4gICAgICAgICAgICBtYXgtd2lkdGg6IDkwdnc7XHJcbiAgICAgICAgICAgIGN1cnNvcjogbW92ZTsgXHJcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44ZW07XHJcbiAgICAgICAgICAgIHVzZXItc2VsZWN0OiBub25lO1xyXG4gICAgICAgIGA7XHJcblxyXG4gICAgICAgIHRoaXMuYXBwbHlJbml0aWFsUG9zaXRpb24odGhpcy5jb250YWluZXIpO1xyXG4gICAgICAgIHRoaXMuc2V0dXBDb250YWluZXJTdHlsZXNBbmREcmFnKHRoaXMuY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgLy8gMS4gTG9jayBCdXR0b25cclxuICAgICAgICBjb25zdCBsb2NrQnRuID0gdGhpcy5jb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgdGV4dDogJ1x1RDgzQ1x1REZBRicsXHJcbiAgICAgICAgICAgIGF0dHI6IHsgXHJcbiAgICAgICAgICAgICAgICBzdHlsZTogJ3BhZGRpbmc6IDJweCA2cHg7IGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7IGZsZXgtc2hyaW5rOiAwOycgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBsb2NrQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy50YXJnZXRGaWxlUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFyZ2V0RmlsZVBhdGggPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIlRhcmdldCB1bmxvY2tlZFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhY3RpdmVGaWxlICYmIGFjdGl2ZUZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YXJnZXRGaWxlUGF0aCA9IGFjdGl2ZUZpbGUucGF0aDtcclxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYExvY2tlZDogJHthY3RpdmVGaWxlLmJhc2VuYW1lfWApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIlNlbGVjdCBhIE1hcmtkb3duIGZpbGUgdG8gbG9jay5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaEhlYWRpbmdzKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIDIuIExhYmVsXHJcbiAgICAgICAgdGhpcy50YXJnZXROYW1lRGlzcGxheSA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZVNwYW4oeyBcclxuICAgICAgICAgICAgdGV4dDogJy4uLicsIFxyXG4gICAgICAgICAgICBhdHRyOiB7IHN0eWxlOiAnZm9udC13ZWlnaHQ6IGJvbGQ7IG1heC13aWR0aDogODBweDsgb3ZlcmZsb3c6IGhpZGRlbjsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7IGRpc3BsYXk6IGlubGluZS1ibG9jazsnIH0gXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIDMuIERyb3Bkb3duXHJcbiAgICAgICAgdGhpcy5kcm9wZG93biA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZUVsKCdzZWxlY3QnLCB7XHJcbiAgICAgICAgICAgIGNsczogJ3NvcnRlci1kcm9wZG93bicsXHJcbiAgICAgICAgICAgIGF0dHI6IHsgc3R5bGU6ICdmbGV4OiAxOyBtaW4td2lkdGg6IDYwcHg7IG1heC13aWR0aDogMTUwcHg7JyB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5kcm9wZG93bi5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRyb3Bkb3duKSB0aGlzLnBsdWdpbi5hY3RpdmVUYXJnZXRIZWFkaW5nID0gdGhpcy5kcm9wZG93bi52YWx1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmRyb3Bkb3duLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCAoZSkgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSwgeyBwYXNzaXZlOiB0cnVlIH0pO1xyXG4gICAgICAgIHRoaXMuZHJvcGRvd24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGUpID0+IGUuc3RvcFByb3BhZ2F0aW9uKCkpO1xyXG5cclxuICAgICAgICAvLyA0LiBTZW5kIEJ1dHRvbiAoVGhlIE1vdmUgTG9naWMpXHJcbiAgICAgICAgY29uc3Qgc2VuZEJ0biA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IFxyXG4gICAgICAgICAgICB0ZXh0OiAnXHUyN0E0JywgXHJcbiAgICAgICAgICAgIGF0dHI6IHsgXHJcbiAgICAgICAgICAgICAgICBzdHlsZTogJ3BhZGRpbmc6IDJweCA4cHg7IGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGNvbG9yOiB2YXIoLS10ZXh0LW9uLWFjY2VudCk7IGJvcmRlcjogbm9uZTsgYm9yZGVyLXJhZGl1czogM3B4OyBmbGV4LXNocmluazogMDsnIFxyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHNlbmRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuICAgICAgICAgICAgaWYgKHZpZXcgJiYgdGhpcy5wbHVnaW4uYWN0aXZlVGFyZ2V0SGVhZGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ubW92ZVBhcmFncmFwaFRvSGVhZGluZ05hbWUodmlldy5lZGl0b3IsIHZpZXcsIHRoaXMucGx1Z2luLmFjdGl2ZVRhcmdldEhlYWRpbmcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSh2aWV3ID8gXCJObyBoZWFkaW5nIHNlbGVjdGVkLlwiIDogXCJPcGVuIE1hcmtkb3duIGZpbGUuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIDUuIENsaXBib2FyZCBCdXR0b25cclxuICAgICAgICBjb25zdCBjbGlwQnRuID0gdGhpcy5jb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgdGV4dDogJ1x1RDgzRFx1RENDQicsXHJcbiAgICAgICAgICAgIGF0dHI6IHtcclxuICAgICAgICAgICAgICAgIHN0eWxlOiAncGFkZGluZzogMnB4IDhweDsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpOyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7IGJvcmRlci1yYWRpdXM6IDNweDsgZmxleC1zaHJpbms6IDA7J1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2xpcEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5hY3RpdmVUYXJnZXRIZWFkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZW5kQ2xpcGJvYXJkVG9IZWFkaW5nKHRoaXMucGx1Z2luLmFjdGl2ZVRhcmdldEhlYWRpbmcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIHRhcmdldCBoZWFkaW5nLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyA2LiBDbG9zZSBCdXR0b25cclxuICAgICAgICBjb25zdCBjbG9zZUJ0biA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgICAgIHRleHQ6ICdcdTAwRDcnLFxyXG4gICAgICAgICAgICBhdHRyOiB7IFxyXG4gICAgICAgICAgICAgICAgc3R5bGU6ICdiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgYm9yZGVyOiBub25lOyBjb2xvcjogdmFyKC0tdGV4dC1tdXRlZCk7IGZvbnQtc2l6ZTogMS4yZW07IGxpbmUtaGVpZ2h0OiAxOyBwYWRkaW5nOiAwIDRweDsgbWFyZ2luLWxlZnQ6IDJweDsgZmxleC1zaHJpbms6IDA7JyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGUoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXBwbHlJbml0aWFsUG9zaXRpb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGxldCBsZWZ0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYmFyTGVmdDtcclxuICAgICAgICBsZXQgdG9wID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYmFyVG9wO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHZpZXdwb3J0V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgICBjb25zdCB2aWV3cG9ydEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxuXHJcbiAgICAgICAgaWYgKGxlZnQgPiB2aWV3cG9ydFdpZHRoIC0gNTApIGxlZnQgPSB2aWV3cG9ydFdpZHRoIC0gMzIwO1xyXG4gICAgICAgIGlmICh0b3AgPiB2aWV3cG9ydEhlaWdodCAtIDUwKSB0b3AgPSB2aWV3cG9ydEhlaWdodCAtIDEwMDtcclxuICAgICAgICBpZiAobGVmdCA8IDApIGxlZnQgPSAxMDtcclxuICAgICAgICBpZiAodG9wIDwgMCkgdG9wID0gMTA7XHJcblxyXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gYCR7bGVmdH1weGA7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IGAke3RvcH1weGA7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXR1cENvbnRhaW5lclN0eWxlc0FuZERyYWcoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGxldCBpc0RyYWdnaW5nID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGRyYWdPZmZzZXQgPSB7IHg6IDAsIHk6IDAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgZ2V0RXZlbnRDb29yZHMgPSAoZTogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBNb3VzZUV2ZW50KSByZXR1cm4geyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9O1xyXG4gICAgICAgICAgICBpZiAoZS50b3VjaGVzICYmIGUudG91Y2hlcy5sZW5ndGggPiAwKSByZXR1cm4geyB4OiBlLnRvdWNoZXNbMF0uY2xpZW50WCwgeTogZS50b3VjaGVzWzBdLmNsaWVudFkgfTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3Qgb25EcmFnU3RhcnQgPSAoZTogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKChlLnRhcmdldCBhcyBIVE1MRWxlbWVudCkuY2xvc2VzdCgnc2VsZWN0LCBidXR0b24nKSkgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgJiYgZS5idXR0b24gIT09IDApIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvb3JkcyA9IGdldEV2ZW50Q29vcmRzKGUpO1xyXG4gICAgICAgICAgICBpZiAoIWNvb3JkcykgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaXNEcmFnZ2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIGRyYWdPZmZzZXQgPSB7IHg6IGNvb3Jkcy54IC0gcmVjdC5sZWZ0LCB5OiBjb29yZHMueSAtIHJlY3QudG9wIH07XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnO1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IFxyXG5cclxuICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBvbkRyYWdNb3ZlKTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbkRyYWdFbmQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25EcmFnTW92ZSwgeyBwYXNzaXZlOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25EcmFnRW5kKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IG9uRHJhZ01vdmUgPSAoZTogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFpc0RyYWdnaW5nKSByZXR1cm47XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgXHJcblxyXG4gICAgICAgICAgICBjb25zdCBjb29yZHMgPSBnZXRFdmVudENvb3JkcyhlKTtcclxuICAgICAgICAgICAgaWYgKCFjb29yZHMpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHggPSBjb29yZHMueCAtIGRyYWdPZmZzZXQueDtcclxuICAgICAgICAgICAgY29uc3QgeSA9IGNvb3Jkcy55IC0gZHJhZ09mZnNldC55O1xyXG5cclxuICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLmxlZnQgPSBgJHt4fXB4YDtcclxuICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IGAke3l9cHhgO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IG9uRHJhZ0VuZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFpc0RyYWdnaW5nKSByZXR1cm47XHJcbiAgICAgICAgICAgIGlzRHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLmN1cnNvciA9ICdtb3ZlJztcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmJhckxlZnQgPSByZWN0LmxlZnQ7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmJhclRvcCA9IHJlY3QudG9wO1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG9uRHJhZ01vdmUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgb25EcmFnRW5kKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25EcmFnTW92ZSk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25EcmFnRW5kKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25EcmFnU3RhcnQpO1xyXG4gICAgICAgIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgb25EcmFnU3RhcnQsIHsgcGFzc2l2ZTogZmFsc2UgfSk7XHJcbiAgICB9XHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBUU87QUFVUCxJQUFNLG1CQUF1QztBQUFBLEVBQ3pDLGlCQUFpQjtBQUFBLEVBQ2pCLFNBQVM7QUFBQSxFQUNULFFBQVE7QUFBQSxFQUNSLGdCQUFnQjtBQUNwQjtBQUdBLElBQXFCLG1CQUFyQixjQUE4Qyx1QkFBTztBQUFBLEVBQXJEO0FBQUE7QUFJSSwrQkFBcUM7QUFBQTtBQUFBLEVBRXJDLE1BQU0sU0FBUztBQUNYLFVBQU0sS0FBSyxhQUFhO0FBR3hCLFNBQUssY0FBYyxJQUFJLG1CQUFtQixJQUFJO0FBRzlDLFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNO0FBQ1osY0FBTSxXQUFXLENBQUMsS0FBSyxTQUFTO0FBQ2hDLGFBQUssWUFBWSxPQUFPLFFBQVE7QUFDaEMsWUFBSSx1QkFBTyxXQUFXLHNCQUFzQixvQkFBb0I7QUFBQSxNQUNwRTtBQUFBLElBQ0osQ0FBQztBQUdELFNBQUssY0FBYyxLQUFLLElBQUksVUFBVSxHQUFHLHNCQUFzQixNQUFNO0FBQ2pFLFdBQUssWUFBWSxnQkFBZ0I7QUFBQSxJQUNyQyxDQUFDLENBQUM7QUFFRixTQUFLLGNBQWMsS0FBSyxJQUFJLGNBQWMsR0FBRyxXQUFXLENBQUMsU0FBUztBQUM5RCxZQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUNwRCxVQUFJLGVBQWUsUUFBUSxLQUFLLFNBQVMsbUJBQW1CLEtBQUssTUFBTTtBQUNuRSxhQUFLLFlBQVksZ0JBQWdCO0FBQUEsTUFDckM7QUFBQSxJQUNKLENBQUMsQ0FBQztBQUVGLFNBQUssY0FBYyxLQUFLLElBQUksTUFBTSxHQUFHLFVBQVUsQ0FBQyxNQUFNLFlBQVk7QUFDOUQsVUFBSSxLQUFLLFNBQVMsbUJBQW1CLFNBQVM7QUFDMUMsYUFBSyxTQUFTLGlCQUFpQixLQUFLO0FBQ3BDLGFBQUssYUFBYTtBQUNsQixhQUFLLFlBQVksZ0JBQWdCO0FBQUEsTUFDckM7QUFBQSxJQUNKLENBQUMsQ0FBQztBQUVGLFNBQUssY0FBYyxLQUFLLElBQUksTUFBTSxHQUFHLFVBQVUsQ0FBQyxTQUFTO0FBQ3JELFVBQUksS0FBSyxTQUFTLG1CQUFtQixLQUFLLE1BQU07QUFDNUMsYUFBSyxTQUFTLGlCQUFpQjtBQUMvQixhQUFLLGFBQWE7QUFDbEIsYUFBSyxZQUFZLGdCQUFnQjtBQUFBLE1BQ3JDO0FBQUEsSUFDSixDQUFDLENBQUM7QUFFRixTQUFLLElBQUksVUFBVSxjQUFjLE1BQU07QUFDbkMsVUFBSSxLQUFLLFNBQVMsaUJBQWlCO0FBQy9CLGFBQUssWUFBWSxPQUFPLE1BQU0sS0FBSztBQUFBLE1BQ3ZDO0FBQUEsSUFDSixDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsTUFBTSxXQUFXO0FBQ2IsU0FBSyxZQUFZLFFBQVE7QUFBQSxFQUM3QjtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ2pCLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDN0U7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNyQztBQUFBO0FBQUEsRUFHQSxZQUFZLE1BQW9DO0FBQzVDLFFBQUksQ0FBQyxRQUFRLEtBQUssY0FBYztBQUFNLGFBQU8sQ0FBQztBQUM5QyxVQUFNLFFBQVEsS0FBSyxJQUFJLGNBQWMsYUFBYSxJQUFJO0FBQ3RELFlBQU8sK0JBQU8sYUFBWSxDQUFDO0FBQUEsRUFDL0I7QUFBQTtBQUFBLEVBR0EsTUFBTSx1QkFBdUIsbUJBQTJCO0FBQ3BELFVBQU0sT0FBTyxNQUFNLFVBQVUsVUFBVSxTQUFTO0FBQ2hELFFBQUksQ0FBQyxRQUFRLEtBQUssS0FBSyxNQUFNLElBQUk7QUFDN0IsVUFBSSx1QkFBTyxxQkFBcUI7QUFDaEM7QUFBQSxJQUNKO0FBR0EsVUFBTSxLQUFLLGlCQUFpQixtQkFBbUIsSUFBSTtBQUFBLEVBQ3ZEO0FBQUE7QUFBQSxFQUdBLE1BQU0sMkJBQTJCLFFBQWdCLE1BQW9CLG1CQUEyQjtBQUM1RixVQUFNLFNBQVMsT0FBTyxVQUFVO0FBQ2hDLFVBQU0sZ0JBQWdCLE9BQU87QUFDN0IsVUFBTSxhQUFhLE9BQU8sUUFBUSxhQUFhO0FBRS9DLFFBQUksQ0FBQyxjQUFjLENBQUMsV0FBVyxLQUFLLEdBQUc7QUFDbkMsVUFBSSx1QkFBTyx3QkFBd0I7QUFDbkM7QUFBQSxJQUNKO0FBR0EsUUFBSSxhQUEyQjtBQUMvQixRQUFJLEtBQUssU0FBUyxnQkFBZ0I7QUFDOUIsWUFBTSxlQUFlLEtBQUssSUFBSSxNQUFNLHNCQUFzQixLQUFLLFNBQVMsY0FBYztBQUN0RixVQUFJLHdCQUF3QjtBQUFPLHFCQUFhO0FBQUEsSUFDcEQ7QUFDQSxRQUFJLENBQUM7QUFBWSxtQkFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBRy9ELFVBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBQ3BELFVBQU0sYUFBYSxlQUFlO0FBRWxDLFFBQUksWUFBWTtBQUVaLFdBQUssNEJBQTRCLFFBQVEsZUFBZSxtQkFBbUIsVUFBVTtBQUFBLElBQ3pGLE9BQU87QUFFSCxVQUFJLFlBQVk7QUFDWixjQUFNLFVBQVUsTUFBTSxLQUFLLHlCQUF5QixZQUFZLG1CQUFtQixVQUFVO0FBQzdGLFlBQUksU0FBUztBQUVULGlCQUFPO0FBQUEsWUFDSDtBQUFBLFlBQ0EsRUFBRSxNQUFNLGVBQWUsSUFBSSxFQUFFO0FBQUEsWUFDN0IsRUFBRSxNQUFNLGdCQUFnQixHQUFHLElBQUksRUFBRTtBQUFBLFVBQ3JDO0FBQ0EsZUFBSyxxQkFBcUIsUUFBUSxhQUFhO0FBQUEsUUFDbkQ7QUFBQSxNQUNKLE9BQU87QUFDSCxZQUFJLHVCQUFPLHdCQUF3QjtBQUFBLE1BQ3ZDO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQTtBQUFBLEVBR0EsNEJBQTRCLFFBQWdCLFlBQW9CLGFBQXFCLE1BQWM7QUFDL0YsVUFBTSxPQUFPLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFDOUMsVUFBTSxXQUFXLEtBQUssWUFBWSxJQUFJO0FBQ3RDLFVBQU0sZ0JBQWdCLFNBQVMsS0FBSyxPQUFLLEVBQUUsWUFBWSxXQUFXO0FBRWxFLFFBQUksQ0FBQyxlQUFlO0FBQ2hCLFVBQUksdUJBQU8sWUFBWSx5QkFBeUI7QUFDaEQ7QUFBQSxJQUNKO0FBRUEsVUFBTSxjQUFjLFNBQVMsUUFBUSxhQUFhO0FBQ2xELFFBQUksa0JBQWtCO0FBRXRCLFFBQUksZ0JBQWdCLFNBQVMsU0FBUyxHQUFHO0FBQ3JDLHdCQUFrQixPQUFPLFVBQVU7QUFBQSxJQUN2QyxPQUFPO0FBQ0gsWUFBTSxjQUFjLFNBQVMsY0FBYyxDQUFDO0FBQzVDLHdCQUFrQixZQUFZLFNBQVMsTUFBTTtBQUFBLElBQ2pEO0FBR0EsUUFBSSxtQkFBbUIsWUFBWTtBQUUvQixhQUFPLGFBQWEsT0FBTyxNQUFNLEVBQUUsTUFBTSxpQkFBaUIsSUFBSSxFQUFFLENBQUM7QUFFakUsWUFBTSxxQkFBcUIsYUFBYTtBQUN4QyxhQUFPO0FBQUEsUUFDSDtBQUFBLFFBQ0EsRUFBRSxNQUFNLG9CQUFvQixJQUFJLEVBQUU7QUFBQSxRQUNsQyxFQUFFLE1BQU0scUJBQXFCLEdBQUcsSUFBSSxFQUFFO0FBQUEsTUFDMUM7QUFHQSxhQUFPLFVBQVUsaUJBQWlCLENBQUM7QUFBQSxJQUN2QyxPQUNLO0FBRUQsYUFBTyxhQUFhLE9BQU8sTUFBTSxFQUFFLE1BQU0saUJBQWlCLElBQUksRUFBRSxDQUFDO0FBRWpFLGFBQU87QUFBQSxRQUNIO0FBQUEsUUFDQSxFQUFFLE1BQU0sWUFBWSxJQUFJLEVBQUU7QUFBQSxRQUMxQixFQUFFLE1BQU0sYUFBYSxHQUFHLElBQUksRUFBRTtBQUFBLE1BQ2xDO0FBRUEsV0FBSyxxQkFBcUIsUUFBUSxVQUFVO0FBQUEsSUFDaEQ7QUFFQSxRQUFJLHVCQUFPLGFBQWEsY0FBYztBQUFBLEVBQzFDO0FBQUE7QUFBQSxFQUdBLE1BQU0saUJBQWlCLG1CQUEyQixTQUFtQztBQUNqRixRQUFJLGFBQTJCO0FBRS9CLFFBQUksS0FBSyxTQUFTLGdCQUFnQjtBQUM5QixZQUFNLGVBQWUsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLEtBQUssU0FBUyxjQUFjO0FBQ3RGLFVBQUksd0JBQXdCO0FBQU8scUJBQWE7QUFBQSxJQUNwRDtBQUVBLFFBQUksQ0FBQyxZQUFZO0FBQ2IsbUJBQWEsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUFBLElBQ2xEO0FBRUEsUUFBSSxDQUFDLFlBQVk7QUFDYixVQUFJLHVCQUFPLDRCQUE0QjtBQUN2QyxhQUFPO0FBQUEsSUFDWDtBQUVBLFFBQUcsV0FBVyxjQUFjLE1BQU07QUFDOUIsVUFBSSx1QkFBTyxpQ0FBaUM7QUFDNUMsYUFBTztBQUFBLElBQ1g7QUFFQSxVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUNwRCxVQUFNLGFBQWEsZUFBZTtBQUNsQyxVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDRCQUFZO0FBRXRFLFFBQUksY0FBYyxZQUFZO0FBQzFCLGFBQU8sS0FBSyxnQkFBZ0IsV0FBVyxRQUFRLG1CQUFtQixPQUFPO0FBQUEsSUFDN0U7QUFFQSxXQUFPLEtBQUsseUJBQXlCLFlBQVksbUJBQW1CLE9BQU87QUFBQSxFQUMvRTtBQUFBO0FBQUEsRUFHQSxnQkFBZ0IsUUFBZ0IsYUFBcUIsTUFBdUI7QUFDeEUsVUFBTSxPQUFPLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFDOUMsVUFBTSxXQUFXLEtBQUssWUFBWSxJQUFJO0FBQ3RDLFVBQU0sZ0JBQWdCLFNBQVMsS0FBSyxPQUFLLEVBQUUsWUFBWSxXQUFXO0FBRWxFLFFBQUksQ0FBQyxlQUFlO0FBQ2hCLFVBQUksdUJBQU8sWUFBWSx5QkFBeUI7QUFDaEQsYUFBTztBQUFBLElBQ1g7QUFFQSxVQUFNLGNBQWMsU0FBUyxRQUFRLGFBQWE7QUFDbEQsUUFBSSxrQkFBa0I7QUFFdEIsUUFBSSxnQkFBZ0IsU0FBUyxTQUFTLEdBQUc7QUFDckMsd0JBQWtCLE9BQU8sVUFBVTtBQUFBLElBQ3ZDLE9BQU87QUFDSCxZQUFNLGNBQWMsU0FBUyxjQUFjLENBQUM7QUFDNUMsd0JBQWtCLFlBQVksU0FBUyxNQUFNO0FBQUEsSUFDakQ7QUFFQSxVQUFNLFlBQVksRUFBRSxNQUFNLGlCQUFpQixJQUFJLEVBQUU7QUFFakQsUUFBSSxtQkFBbUIsT0FBTyxVQUFVLEdBQUc7QUFDdkMsYUFBTyxhQUFhLE9BQU8sTUFBTSxFQUFFLE1BQU0sT0FBTyxVQUFVLEdBQUcsSUFBSSxFQUFFLENBQUM7QUFBQSxJQUN4RSxPQUFPO0FBQ0gsYUFBTyxhQUFhLE9BQU8sTUFBTSxTQUFTO0FBQUEsSUFDOUM7QUFFQSxRQUFJLHVCQUFPLGNBQWMsY0FBYztBQUN2QyxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsTUFBTSx5QkFBeUIsTUFBYSxhQUFxQixNQUFnQztBQUM3RixVQUFNLGNBQWMsTUFBTSxLQUFLLElBQUksTUFBTSxLQUFLLElBQUk7QUFDbEQsVUFBTSxXQUFXLEtBQUssWUFBWSxJQUFJO0FBRXRDLFVBQU0sZ0JBQWdCLFNBQVMsS0FBSyxPQUFLLEVBQUUsWUFBWSxXQUFXO0FBQ2xFLFFBQUksQ0FBQyxlQUFlO0FBQ2hCLFVBQUksdUJBQU8sWUFBWSxtQ0FBbUM7QUFDMUQsYUFBTztBQUFBLElBQ1g7QUFFQSxVQUFNLFFBQVEsWUFBWSxNQUFNLElBQUk7QUFDcEMsVUFBTSxjQUFjLFNBQVMsUUFBUSxhQUFhO0FBRWxELFFBQUksYUFBYSxNQUFNO0FBRXZCLFFBQUksY0FBYyxTQUFTLFNBQVMsR0FBRztBQUNuQyxZQUFNLGNBQWMsU0FBUyxjQUFjLENBQUM7QUFDNUMsbUJBQWEsWUFBWSxTQUFTLE1BQU07QUFBQSxJQUM1QztBQUVBLFVBQU0sT0FBTyxZQUFZLEdBQUcsSUFBSTtBQUVoQyxVQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sTUFBTSxNQUFNLEtBQUssSUFBSSxDQUFDO0FBQ2xELFFBQUksdUJBQU8sWUFBWSxLQUFLLFdBQVc7QUFDdkMsV0FBTztBQUFBLEVBQ1g7QUFBQSxFQUVBLHFCQUFxQixRQUFnQixhQUFxQjtBQUN0RCxVQUFNLFdBQVcsT0FBTyxVQUFVO0FBQ2xDLFFBQUksZUFBZSxVQUFVO0FBQ3hCLGFBQU8sVUFBVSxXQUFXLEdBQUcsQ0FBQztBQUFBLElBQ3JDLE9BQU87QUFDSCxhQUFPLFVBQVUsYUFBYSxDQUFDO0FBQUEsSUFDbkM7QUFBQSxFQUNKO0FBQ0o7QUFLQSxJQUFNLHFCQUFOLE1BQXlCO0FBQUEsRUFPckIsWUFBWSxRQUEwQjtBQUp0QyxTQUFPLFlBQWdDO0FBQ3ZDLFNBQVEsV0FBcUM7QUFDN0MsU0FBUSxvQkFBd0M7QUFHNUMsU0FBSyxTQUFTO0FBQ2QsU0FBSyxNQUFNLE9BQU87QUFBQSxFQUN0QjtBQUFBLEVBRU8sVUFBVTtBQUNiLFFBQUksS0FBSyxXQUFXO0FBQ2hCLFdBQUssVUFBVSxPQUFPO0FBQ3RCLFdBQUssWUFBWTtBQUFBLElBQ3JCO0FBQ0EsU0FBSyxXQUFXO0FBQUEsRUFDcEI7QUFBQSxFQUVBLE1BQWEsT0FBTyxNQUFlLE9BQWdCLE1BQU07QUFDckQsU0FBSyxRQUFRO0FBQ2IsUUFBSSxNQUFNO0FBQ04sV0FBSyxTQUFTO0FBQ2QsaUJBQVcsTUFBTSxLQUFLLGdCQUFnQixHQUFHLEVBQUU7QUFBQSxJQUMvQztBQUNBLFFBQUksTUFBTTtBQUNOLFdBQUssT0FBTyxTQUFTLGtCQUFrQjtBQUN2QyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDbkM7QUFBQSxFQUNKO0FBQUEsRUFFTyxrQkFBa0I7QUFDckIsUUFBSSxDQUFDLEtBQUssWUFBWSxDQUFDLEtBQUs7QUFBbUI7QUFFL0MsUUFBSSxhQUEyQjtBQUMvQixRQUFJLFdBQVc7QUFFZixRQUFJLEtBQUssT0FBTyxTQUFTLGdCQUFnQjtBQUNyQyxZQUFNLElBQUksS0FBSyxJQUFJLE1BQU0sc0JBQXNCLEtBQUssT0FBTyxTQUFTLGNBQWM7QUFDbEYsVUFBSSxhQUFhLHVCQUFPO0FBQ3BCLHFCQUFhO0FBQ2IsbUJBQVc7QUFBQSxNQUNmO0FBQUEsSUFDSjtBQUVBLFFBQUksQ0FBQyxZQUFZO0FBQ2IsbUJBQWEsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUFBLElBQ2xEO0FBRUEsUUFBSSxZQUFZO0FBQ1osV0FBSyxrQkFBa0IsUUFBUSxXQUFXLGFBQU0sV0FBVyxhQUFhLGFBQU0sV0FBVyxVQUFVO0FBQ25HLFdBQUssa0JBQWtCLE1BQU0sUUFBUSxXQUFXLHVCQUF1QjtBQUFBLElBQzNFLE9BQU87QUFDSCxXQUFLLGtCQUFrQixRQUFRLFNBQVM7QUFBQSxJQUM1QztBQUVBLFNBQUssU0FBUyxNQUFNO0FBRXBCLFFBQUksQ0FBQyxjQUFjLFdBQVcsY0FBYyxNQUFNO0FBQzlDLFdBQUssU0FBUyxTQUFTLFVBQVUsRUFBRSxNQUFNLG1CQUFtQixPQUFPLEdBQUcsQ0FBQztBQUN2RSxXQUFLLE9BQU8sc0JBQXNCO0FBQ2xDO0FBQUEsSUFDSjtBQUVBLFVBQU0sV0FBVyxLQUFLLE9BQU8sWUFBWSxVQUFVO0FBRW5ELFFBQUksU0FBUyxXQUFXLEdBQUc7QUFDdkIsV0FBSyxTQUFTLFNBQVMsVUFBVSxFQUFFLE1BQU0sZUFBZSxPQUFPLEdBQUcsQ0FBQztBQUNuRSxXQUFLLE9BQU8sc0JBQXNCO0FBQ2xDO0FBQUEsSUFDSjtBQUVBLGFBQVMsUUFBUSxPQUFLO0FBQ2xCLFlBQU0sU0FBUyxPQUFTLFFBQVEsRUFBRSxRQUFRLEtBQUssQ0FBQztBQUNoRCxXQUFLLFNBQVUsU0FBUyxVQUFVO0FBQUEsUUFDOUIsTUFBTSxHQUFHLFdBQVcsRUFBRTtBQUFBLFFBQ3RCLE9BQU8sRUFBRTtBQUFBLE1BQ2IsQ0FBQztBQUFBLElBQ0wsQ0FBQztBQUVELFVBQU0sbUJBQW1CLEtBQUssT0FBTztBQUNyQyxRQUFJLG9CQUFvQixTQUFTLEtBQUssT0FBSyxFQUFFLFlBQVksZ0JBQWdCLEdBQUc7QUFDeEUsV0FBSyxTQUFTLFFBQVE7QUFBQSxJQUMxQixPQUFPO0FBQ0gsV0FBSyxTQUFTLGdCQUFnQjtBQUM5QixXQUFLLE9BQU8sc0JBQXNCLEtBQUssU0FBUztBQUFBLElBQ3BEO0FBQUEsRUFDSjtBQUFBLEVBRVEsV0FBVztBQUNmLFNBQUssWUFBWSxTQUFTLEtBQUssVUFBVSxFQUFFLEtBQUssc0JBQXNCLENBQUM7QUFFdkUsU0FBSyxVQUFVLE1BQU0sVUFBVTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBa0IvQixTQUFLLHFCQUFxQixLQUFLLFNBQVM7QUFDeEMsU0FBSyw0QkFBNEIsS0FBSyxTQUFTO0FBRy9DLFVBQU0sVUFBVSxLQUFLLFVBQVUsU0FBUyxVQUFVO0FBQUEsTUFDOUMsTUFBTTtBQUFBLE1BQ04sTUFBTTtBQUFBLFFBQ0YsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKLENBQUM7QUFDRCxZQUFRLGlCQUFpQixTQUFTLENBQUMsTUFBTTtBQUNyQyxRQUFFLGdCQUFnQjtBQUNsQixZQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsY0FBYztBQUNwRCxVQUFJLEtBQUssT0FBTyxTQUFTLGdCQUFnQjtBQUNyQyxhQUFLLE9BQU8sU0FBUyxpQkFBaUI7QUFDdEMsWUFBSSx1QkFBTyxpQkFBaUI7QUFBQSxNQUNoQyxXQUFXLGNBQWMsV0FBVyxjQUFjLE1BQU07QUFDcEQsYUFBSyxPQUFPLFNBQVMsaUJBQWlCLFdBQVc7QUFDakQsWUFBSSx1QkFBTyxXQUFXLFdBQVcsVUFBVTtBQUFBLE1BQy9DLE9BQU87QUFDSCxZQUFJLHVCQUFPLGlDQUFpQztBQUFBLE1BQ2hEO0FBQ0EsV0FBSyxPQUFPLGFBQWE7QUFDekIsV0FBSyxnQkFBZ0I7QUFBQSxJQUN6QixDQUFDO0FBR0QsU0FBSyxvQkFBb0IsS0FBSyxVQUFVLFdBQVc7QUFBQSxNQUMvQyxNQUFNO0FBQUEsTUFDTixNQUFNLEVBQUUsT0FBTyw2SEFBNkg7QUFBQSxJQUNoSixDQUFDO0FBR0QsU0FBSyxXQUFXLEtBQUssVUFBVSxTQUFTLFVBQVU7QUFBQSxNQUM5QyxLQUFLO0FBQUEsTUFDTCxNQUFNLEVBQUUsT0FBTyw4Q0FBOEM7QUFBQSxJQUNqRSxDQUFDO0FBQ0QsU0FBSyxTQUFTLGlCQUFpQixVQUFVLE1BQU07QUFDM0MsVUFBSSxLQUFLO0FBQVUsYUFBSyxPQUFPLHNCQUFzQixLQUFLLFNBQVM7QUFBQSxJQUN2RSxDQUFDO0FBQ0QsU0FBSyxTQUFTLGlCQUFpQixjQUFjLENBQUMsTUFBTSxFQUFFLGdCQUFnQixHQUFHLEVBQUUsU0FBUyxLQUFLLENBQUM7QUFDMUYsU0FBSyxTQUFTLGlCQUFpQixhQUFhLENBQUMsTUFBTSxFQUFFLGdCQUFnQixDQUFDO0FBR3RFLFVBQU0sVUFBVSxLQUFLLFVBQVUsU0FBUyxVQUFVO0FBQUEsTUFDOUMsTUFBTTtBQUFBLE1BQ04sTUFBTTtBQUFBLFFBQ0YsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKLENBQUM7QUFDRCxZQUFRLGlCQUFpQixTQUFTLENBQUMsTUFBTTtBQUNyQyxRQUFFLGdCQUFnQjtBQUNsQixZQUFNLE9BQU8sS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDRCQUFZO0FBQ2hFLFVBQUksUUFBUSxLQUFLLE9BQU8scUJBQXFCO0FBQ3pDLGFBQUssT0FBTywyQkFBMkIsS0FBSyxRQUFRLE1BQU0sS0FBSyxPQUFPLG1CQUFtQjtBQUFBLE1BQzdGLE9BQU87QUFDSCxZQUFJLHVCQUFPLE9BQU8seUJBQXlCLHFCQUFxQjtBQUFBLE1BQ3BFO0FBQUEsSUFDSixDQUFDO0FBR0QsVUFBTSxVQUFVLEtBQUssVUFBVSxTQUFTLFVBQVU7QUFBQSxNQUM5QyxNQUFNO0FBQUEsTUFDTixNQUFNO0FBQUEsUUFDRixPQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0osQ0FBQztBQUNELFlBQVEsaUJBQWlCLFNBQVMsQ0FBQyxNQUFNO0FBQ3JDLFFBQUUsZ0JBQWdCO0FBQ2xCLFVBQUksS0FBSyxPQUFPLHFCQUFxQjtBQUNqQyxhQUFLLE9BQU8sdUJBQXVCLEtBQUssT0FBTyxtQkFBbUI7QUFBQSxNQUN0RSxPQUFPO0FBQ0gsWUFBSSx1QkFBTyxvQkFBb0I7QUFBQSxNQUNuQztBQUFBLElBQ0osQ0FBQztBQUdELFVBQU0sV0FBVyxLQUFLLFVBQVUsU0FBUyxVQUFVO0FBQUEsTUFDL0MsTUFBTTtBQUFBLE1BQ04sTUFBTTtBQUFBLFFBQ0YsT0FBTztBQUFBLE1BQ1g7QUFBQSxJQUNKLENBQUM7QUFDRCxhQUFTLGlCQUFpQixTQUFTLENBQUMsTUFBTTtBQUN0QyxRQUFFLGdCQUFnQjtBQUNsQixXQUFLLE9BQU8sS0FBSztBQUFBLElBQ3JCLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFUSxxQkFBcUIsV0FBd0I7QUFDakQsUUFBSSxPQUFPLEtBQUssT0FBTyxTQUFTO0FBQ2hDLFFBQUksTUFBTSxLQUFLLE9BQU8sU0FBUztBQUUvQixVQUFNLGdCQUFnQixPQUFPO0FBQzdCLFVBQU0saUJBQWlCLE9BQU87QUFFOUIsUUFBSSxPQUFPLGdCQUFnQjtBQUFJLGFBQU8sZ0JBQWdCO0FBQ3RELFFBQUksTUFBTSxpQkFBaUI7QUFBSSxZQUFNLGlCQUFpQjtBQUN0RCxRQUFJLE9BQU87QUFBRyxhQUFPO0FBQ3JCLFFBQUksTUFBTTtBQUFHLFlBQU07QUFFbkIsY0FBVSxNQUFNLE9BQU8sR0FBRztBQUMxQixjQUFVLE1BQU0sTUFBTSxHQUFHO0FBQUEsRUFDN0I7QUFBQSxFQUVRLDRCQUE0QixXQUF3QjtBQUN4RCxRQUFJLGFBQWE7QUFDakIsUUFBSSxhQUFhLEVBQUUsR0FBRyxHQUFHLEdBQUcsRUFBRTtBQUU5QixVQUFNLGlCQUFpQixDQUFDLE1BQStCO0FBQ25ELFVBQUksYUFBYTtBQUFZLGVBQU8sRUFBRSxHQUFHLEVBQUUsU0FBUyxHQUFHLEVBQUUsUUFBUTtBQUNqRSxVQUFJLEVBQUUsV0FBVyxFQUFFLFFBQVEsU0FBUztBQUFHLGVBQU8sRUFBRSxHQUFHLEVBQUUsUUFBUSxDQUFDLEVBQUUsU0FBUyxHQUFHLEVBQUUsUUFBUSxDQUFDLEVBQUUsUUFBUTtBQUNqRyxhQUFPO0FBQUEsSUFDWDtBQUVBLFVBQU0sY0FBYyxDQUFDLE1BQStCO0FBQ2hELFVBQUssRUFBRSxPQUF1QixRQUFRLGdCQUFnQjtBQUFHO0FBQ3pELFVBQUksYUFBYSxjQUFjLEVBQUUsV0FBVztBQUFHO0FBRS9DLFlBQU0sU0FBUyxlQUFlLENBQUM7QUFDL0IsVUFBSSxDQUFDO0FBQVE7QUFFYixtQkFBYTtBQUNiLFlBQU0sT0FBTyxVQUFVLHNCQUFzQjtBQUM3QyxtQkFBYSxFQUFFLEdBQUcsT0FBTyxJQUFJLEtBQUssTUFBTSxHQUFHLE9BQU8sSUFBSSxLQUFLLElBQUk7QUFDL0QsZ0JBQVUsTUFBTSxTQUFTO0FBQ3pCLFFBQUUsZUFBZTtBQUVqQixVQUFJLGFBQWEsWUFBWTtBQUN6QixpQkFBUyxpQkFBaUIsYUFBYSxVQUFVO0FBQ2pELGlCQUFTLGlCQUFpQixXQUFXLFNBQVM7QUFBQSxNQUNsRCxPQUFPO0FBQ0gsaUJBQVMsaUJBQWlCLGFBQWEsWUFBWSxFQUFFLFNBQVMsTUFBTSxDQUFDO0FBQ3JFLGlCQUFTLGlCQUFpQixZQUFZLFNBQVM7QUFBQSxNQUNuRDtBQUFBLElBQ0o7QUFFQSxVQUFNLGFBQWEsQ0FBQyxNQUErQjtBQUMvQyxVQUFJLENBQUM7QUFBWTtBQUNqQixRQUFFLGVBQWU7QUFFakIsWUFBTSxTQUFTLGVBQWUsQ0FBQztBQUMvQixVQUFJLENBQUM7QUFBUTtBQUViLFlBQU0sSUFBSSxPQUFPLElBQUksV0FBVztBQUNoQyxZQUFNLElBQUksT0FBTyxJQUFJLFdBQVc7QUFFaEMsZ0JBQVUsTUFBTSxPQUFPLEdBQUc7QUFDMUIsZ0JBQVUsTUFBTSxNQUFNLEdBQUc7QUFBQSxJQUM3QjtBQUVBLFVBQU0sWUFBWSxNQUFNO0FBQ3BCLFVBQUksQ0FBQztBQUFZO0FBQ2pCLG1CQUFhO0FBQ2IsZ0JBQVUsTUFBTSxTQUFTO0FBRXpCLFlBQU0sT0FBTyxVQUFVLHNCQUFzQjtBQUM3QyxXQUFLLE9BQU8sU0FBUyxVQUFVLEtBQUs7QUFDcEMsV0FBSyxPQUFPLFNBQVMsU0FBUyxLQUFLO0FBQ25DLFdBQUssT0FBTyxhQUFhO0FBRXpCLGVBQVMsb0JBQW9CLGFBQWEsVUFBVTtBQUNwRCxlQUFTLG9CQUFvQixXQUFXLFNBQVM7QUFDakQsZUFBUyxvQkFBb0IsYUFBYSxVQUFVO0FBQ3BELGVBQVMsb0JBQW9CLFlBQVksU0FBUztBQUFBLElBQ3REO0FBRUEsY0FBVSxpQkFBaUIsYUFBYSxXQUFXO0FBQ25ELGNBQVUsaUJBQWlCLGNBQWMsYUFBYSxFQUFFLFNBQVMsTUFBTSxDQUFDO0FBQUEsRUFDNUU7QUFDSjsiLAogICJuYW1lcyI6IFtdCn0K
