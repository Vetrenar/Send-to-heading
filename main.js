/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TextSorterPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  showFloatingBar: true,
  barLeft: 20,
  barTop: 80,
  targetFilePath: null,
  useCustomFormatting: true,
  mdTemplate: "{{text}} (Source: [[{{file}}]])",
  pdfTemplate: "{{text}} (Source: [[{{file}}#page={{page}}]])",
  webTemplate: "{{text}} (Source: [Web]({{url}}))"
};
var TextSorterPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.activeTargetHeading = null;
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new TextSorterSettingTab(this.app, this));
    this.floatingBar = new SortingFloatingBar(this);
    this.addCommand({
      id: "toggle-sorter-bar",
      name: "Show/Hide sorting bar",
      callback: () => this.floatingBar.toggle(!this.settings.showFloatingBar)
    });
    this.addCommand({
      id: "send-smart",
      name: "Send selection/line to target heading",
      callback: () => this.handleTransfer("smart")
    });
    this.addCommand({
      id: "send-clipboard",
      name: "Send clipboard to target heading",
      callback: () => this.handleTransfer("clipboard")
    });
    this.registerEvent(this.app.vault.on("rename", (file, oldPath) => {
      if (oldPath === this.settings.targetFilePath) {
        this.settings.targetFilePath = file.path;
        this.saveSettings();
        this.floatingBar.refreshHeadings();
      }
    }));
    this.registerEvent(this.app.workspace.on("active-leaf-change", () => this.floatingBar.refreshHeadings()));
    this.registerEvent(this.app.metadataCache.on("changed", (file) => {
      if (file.path === this.settings.targetFilePath || file === this.app.workspace.getActiveFile()) {
        this.floatingBar.refreshHeadings();
      }
    }));
    this.app.workspace.onLayoutReady(() => {
      if (this.settings.showFloatingBar)
        this.floatingBar.toggle(true, false);
    });
  }
  async onunload() {
    this.floatingBar.clearUI();
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  // 2) ACTUAL FORMATTING LOGIC USING {{text}}
  async formatOutput(rawText, activeView) {
    var _a, _b, _c, _d, _e, _f;
    if (!this.settings.useCustomFormatting || !activeView)
      return rawText;
    const viewType = activeView.getViewType();
    if (["web-viewer", "webviewer", "webview", "surfer-view"].includes(viewType)) {
      const url = ((_a = activeView.getState()) == null ? void 0 : _a.url) || activeView.url;
      return this.settings.webTemplate.replace("{{text}}", rawText).replace("{{url}}", url || "");
    }
    if (viewType === "pdf") {
      const file = activeView.file;
      const internalViewer = (_d = (_c = (_b = activeView.viewer) == null ? void 0 : _b.child) == null ? void 0 : _c.pdfViewer) == null ? void 0 : _d.pdfViewer;
      const page = ((_e = internalViewer == null ? void 0 : internalViewer._location) == null ? void 0 : _e.pageNumber) || (internalViewer == null ? void 0 : internalViewer.currentPageNumber) || ((_f = activeView.getState()) == null ? void 0 : _f.page) || 1;
      if (file instanceof import_obsidian.TFile) {
        return this.settings.pdfTemplate.replace("{{text}}", rawText).replace("{{file}}", file.path).replace("{{page}}", page.toString());
      }
    }
    if (viewType === "markdown") {
      const file = activeView.file;
      if (file instanceof import_obsidian.TFile) {
        return this.settings.mdTemplate.replace("{{text}}", rawText).replace("{{file}}", file.path);
      }
    }
    return rawText;
  }
  async handleTransfer(type) {
    var _a, _b, _c, _d, _e, _f, _g;
    const activeLeaf = this.app.workspace.getMostRecentLeaf();
    const activeView = activeLeaf == null ? void 0 : activeLeaf.view;
    if (!this.activeTargetHeading) {
      new import_obsidian.Notice("No target heading selected.");
      return;
    }
    let extractedText = "";
    if (type === "clipboard") {
      extractedText = await navigator.clipboard.readText();
    } else if (type === "smart") {
      const viewType = activeView == null ? void 0 : activeView.getViewType();
      if (viewType === "pdf") {
        extractedText = ((_e = (_d = (_c = (_b = (_a = activeView.viewer) == null ? void 0 : _a.child) == null ? void 0 : _b.pdfViewer) == null ? void 0 : _c.pdfViewer) == null ? void 0 : _d.textSelectionManager) == null ? void 0 : _e.getSelectedText()) || "";
        if (!extractedText)
          extractedText = ((_f = window.getSelection()) == null ? void 0 : _f.toString()) || "";
      } else if (["web-viewer", "webviewer", "webview", "surfer-view"].includes(viewType)) {
        const webviewEl = activeView.contentEl.querySelector("webview");
        if (webviewEl && webviewEl.executeJavaScript) {
          try {
            extractedText = await webviewEl.executeJavaScript("window.getSelection().toString()");
          } catch (e) {
            console.error("Webview JS failed", e);
          }
        }
        if (!extractedText || !extractedText.trim()) {
          extractedText = await navigator.clipboard.readText();
        }
      } else if (viewType === "markdown") {
        const isReadingMode = activeView.getMode() === "preview";
        const editor = activeView.editor;
        if (isReadingMode) {
          extractedText = ((_g = window.getSelection()) == null ? void 0 : _g.toString()) || "";
        } else {
          const selection = editor.getSelection();
          if (selection && selection.trim().length > 0) {
            const formatted = await this.formatOutput(selection, activeView);
            const success = await this.processTransfer(this.activeTargetHeading, formatted);
            if (success)
              editor.replaceSelection("");
            return;
          } else {
            const lineNum = editor.getCursor().line;
            const lineText = editor.getLine(lineNum);
            if (lineText.trim()) {
              const formatted = await this.formatOutput(lineText, activeView);
              const success = await this.processTransfer(this.activeTargetHeading, formatted);
              if (success) {
                editor.replaceRange("", { line: lineNum, ch: 0 }, { line: lineNum + 1, ch: 0 });
              }
            }
            return;
          }
        }
      }
    }
    if (!extractedText || !extractedText.trim()) {
      new import_obsidian.Notice("Selection is empty.");
      return;
    }
    const finalFormatted = await this.formatOutput(extractedText, activeView);
    await this.processTransfer(this.activeTargetHeading, finalFormatted);
  }
  async processTransfer(headingName, text) {
    let targetFile = null;
    if (this.settings.targetFilePath) {
      const f = this.app.vault.getAbstractFileByPath(this.settings.targetFilePath);
      if (f instanceof import_obsidian.TFile)
        targetFile = f;
    }
    if (!targetFile)
      targetFile = this.app.workspace.getActiveFile();
    if (!targetFile || targetFile.extension !== "md") {
      new import_obsidian.Notice("Target must be a Markdown file.");
      return false;
    }
    let openEditor = null;
    this.app.workspace.iterateAllLeaves((leaf) => {
      if (leaf.view instanceof import_obsidian.MarkdownView && leaf.view.file.path === (targetFile == null ? void 0 : targetFile.path)) {
        openEditor = leaf.view.editor;
      }
    });
    if (openEditor) {
      return this.insertViaEditor(openEditor, targetFile, headingName, text);
    }
    return this.insertViaVaultProcess(targetFile, headingName, text);
  }
  insertViaEditor(editor, file, headingName, text) {
    const cache = this.app.metadataCache.getFileCache(file);
    const headings = (cache == null ? void 0 : cache.headings) || [];
    const targetIdx = headings.findIndex((h) => h.heading === headingName);
    if (targetIdx === -1) {
      new import_obsidian.Notice(`Heading "${headingName}" not found.`);
      return false;
    }
    const isLastHeading = targetIdx === headings.length - 1;
    const insertLine = isLastHeading ? editor.lineCount() : headings[targetIdx + 1].position.start.line;
    const content = `
${text}
`;
    editor.replaceRange(content, { line: insertLine, ch: 0 });
    new import_obsidian.Notice(`Added to "${headingName}"`);
    return true;
  }
  async insertViaVaultProcess(file, headingName, text) {
    try {
      await this.app.vault.process(file, (data) => {
        const lines = data.split("\n");
        const cache = this.app.metadataCache.getFileCache(file);
        const headings = (cache == null ? void 0 : cache.headings) || [];
        const targetIdx = headings.findIndex((h) => h.heading === headingName);
        if (targetIdx === -1)
          throw new Error("Heading not found");
        const isLastHeading = targetIdx === headings.length - 1;
        const insertLine = isLastHeading ? lines.length : headings[targetIdx + 1].position.start.line;
        lines.splice(insertLine, 0, text);
        return lines.join("\n");
      });
      new import_obsidian.Notice(`Sent to "${file.basename}"`);
      return true;
    } catch (e) {
      new import_obsidian.Notice(e.message);
      return false;
    }
  }
  getHeadings(file) {
    var _a;
    if (!file)
      return [];
    return ((_a = this.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.headings) || [];
  }
};
var SortingFloatingBar = class {
  constructor(plugin) {
    this.container = null;
    this.dropdown = null;
    this.label = null;
    this.moveBtn = null;
    this.plugin = plugin;
  }
  clearUI() {
    var _a;
    (_a = this.container) == null ? void 0 : _a.remove();
    this.container = null;
  }
  async toggle(show, save = true) {
    this.clearUI();
    if (show) {
      this.createUI();
      this.refreshHeadings();
    }
    if (save) {
      this.plugin.settings.showFloatingBar = show;
      await this.plugin.saveSettings();
    }
  }
  createUI() {
    this.container = this.plugin.app.workspace.containerEl.createDiv({ cls: "sorter-bar" });
    Object.assign(this.container.style, {
      position: "absolute",
      zIndex: "var(--layer-cover)",
      left: `${this.plugin.settings.barLeft}px`,
      top: `${this.plugin.settings.barTop}px`,
      background: "var(--background-primary)",
      border: "1px solid var(--background-modifier-border)",
      borderRadius: "8px",
      padding: "5px 10px",
      boxShadow: "var(--shadow-l)",
      display: "flex",
      gap: "8px",
      alignItems: "center"
    });
    const createBtn = (text, cb, cls = "") => {
      const btn = this.container.createEl("button", { text, cls });
      btn.addEventListener("mousedown", (e) => {
        e.preventDefault();
        cb();
      });
      btn.addEventListener("click", (e) => e.preventDefault());
      return btn;
    };
    createBtn("\u{1F3AF}", async () => {
      const active = this.plugin.app.workspace.getActiveFile();
      this.plugin.settings.targetFilePath = this.plugin.settings.targetFilePath ? null : (active == null ? void 0 : active.path) || null;
      await this.plugin.saveSettings();
      this.refreshHeadings();
      new import_obsidian.Notice(this.plugin.settings.targetFilePath ? "Locked Target File" : "Targeting Active File");
    });
    this.label = this.container.createSpan({ attr: { style: "font-size:0.8em; max-width:80px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;" } });
    this.dropdown = this.container.createEl("select");
    this.dropdown.onchange = () => this.plugin.activeTargetHeading = this.dropdown.value;
    this.moveBtn = createBtn("\u27A4", () => this.plugin.handleTransfer("smart"), "mod-cta");
    createBtn("\u{1F4CB}", () => this.plugin.handleTransfer("clipboard"));
    createBtn("\xD7", () => this.toggle(false));
    this.setupDrag(this.container);
  }
  refreshHeadings() {
    if (!this.dropdown || !this.label || !this.container || !this.moveBtn)
      return;
    const activeLeaf = this.plugin.app.workspace.getMostRecentLeaf();
    const viewType = activeLeaf == null ? void 0 : activeLeaf.view.getViewType();
    const isValidView = ["markdown", "pdf", "web-viewer", "webviewer", "surfer-view"].includes(viewType);
    if (!isValidView) {
      this.container.style.display = "none";
      return;
    } else {
      this.container.style.display = "flex";
    }
    const isMarkdown = viewType === "markdown";
    const isReadingMode = isMarkdown && activeLeaf.view.getMode() === "preview";
    const hasSelection = isMarkdown && !isReadingMode && activeLeaf.view.editor.getSelection().length > 0;
    const isNonEditable = ["pdf", "web-viewer", "webviewer", "surfer-view"].includes(viewType) || isReadingMode || hasSelection;
    this.moveBtn.setText(isNonEditable ? "\u2728" : "\u27A4");
    this.moveBtn.title = isNonEditable ? "Send Selection" : "Move Current Line";
    const targetPath = this.plugin.settings.targetFilePath;
    const file = targetPath ? this.plugin.app.vault.getAbstractFileByPath(targetPath) : this.plugin.app.workspace.getActiveFile();
    if (file instanceof import_obsidian.TFile && file.extension === "md") {
      this.label.setText((targetPath ? "\u{1F512} " : "\u{1F4C4} ") + file.basename);
      const currentSelected = this.plugin.activeTargetHeading;
      const headings = this.plugin.getHeadings(file);
      this.dropdown.empty();
      headings.forEach((h) => {
        const opt = this.dropdown.createEl("option", { text: h.heading, value: h.heading });
        if (h.heading === currentSelected)
          opt.selected = true;
      });
      this.plugin.activeTargetHeading = this.dropdown.value;
    } else {
      this.label.setText("No MD Target");
      this.dropdown.empty();
      this.plugin.activeTargetHeading = null;
    }
  }
  setupDrag(el) {
    let isDown = false, offset = [0, 0];
    const onMouseDown = (e) => {
      if (e.target instanceof HTMLSelectElement || e.target instanceof HTMLButtonElement)
        return;
      isDown = true;
      offset = [el.offsetLeft - e.clientX, el.offsetTop - e.clientY];
    };
    const onMouseMove = (e) => {
      if (!isDown)
        return;
      el.style.left = e.clientX + offset[0] + "px";
      el.style.top = e.clientY + offset[1] + "px";
    };
    const onMouseUp = async () => {
      if (!isDown)
        return;
      isDown = false;
      this.plugin.settings.barLeft = el.offsetLeft;
      this.plugin.settings.barTop = el.offsetTop;
      await this.plugin.saveSettings();
    };
    this.plugin.registerDomEvent(el, "mousedown", onMouseDown);
    this.plugin.registerDomEvent(window, "mousemove", onMouseMove);
    this.plugin.registerDomEvent(window, "mouseup", onMouseUp);
  }
};
var TextSorterSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Formatting & Templates" });
    new import_obsidian.Setting(containerEl).setName("Use Custom Appending Formats").setDesc("Apply the templates below to your text. Use {{text}} for the content.").addToggle((t) => t.setValue(this.plugin.settings.useCustomFormatting).onChange(async (v) => {
      this.plugin.settings.useCustomFormatting = v;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Markdown Template").setDesc("Variables: {{text}}, {{file}}").addTextArea((t) => t.setValue(this.plugin.settings.mdTemplate).onChange(async (v) => {
      this.plugin.settings.mdTemplate = v;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("PDF Template").setDesc("Variables: {{text}}, {{file}}, {{page}}").addTextArea((t) => t.setValue(this.plugin.settings.pdfTemplate).onChange(async (v) => {
      this.plugin.settings.pdfTemplate = v;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Web Viewer Template").setDesc("Variables: {{text}}, {{url}}").addTextArea((t) => t.setValue(this.plugin.settings.webTemplate).onChange(async (v) => {
      this.plugin.settings.webTemplate = v;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgXHJcbiAgICBBcHAsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBQbHVnaW4sIE5vdGljZSwgVEZpbGUsIFxyXG4gICAgSGVhZGluZ0NhY2hlLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBUQWJzdHJhY3RGaWxlIFxyXG59IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmludGVyZmFjZSBUZXh0U29ydGVyU2V0dGluZ3Mge1xyXG4gICAgc2hvd0Zsb2F0aW5nQmFyOiBib29sZWFuO1xyXG4gICAgYmFyTGVmdDogbnVtYmVyO1xyXG4gICAgYmFyVG9wOiBudW1iZXI7XHJcbiAgICB0YXJnZXRGaWxlUGF0aDogc3RyaW5nIHwgbnVsbDtcclxuICAgIHVzZUN1c3RvbUZvcm1hdHRpbmc6IGJvb2xlYW47XHJcbiAgICBtZFRlbXBsYXRlOiBzdHJpbmc7XHJcbiAgICBwZGZUZW1wbGF0ZTogc3RyaW5nO1xyXG4gICAgd2ViVGVtcGxhdGU6IHN0cmluZztcclxufVxyXG5cclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogVGV4dFNvcnRlclNldHRpbmdzID0ge1xyXG4gICAgc2hvd0Zsb2F0aW5nQmFyOiB0cnVlLFxyXG4gICAgYmFyTGVmdDogMjAsXHJcbiAgICBiYXJUb3A6IDgwLFxyXG4gICAgdGFyZ2V0RmlsZVBhdGg6IG51bGwsXHJcbiAgICB1c2VDdXN0b21Gb3JtYXR0aW5nOiB0cnVlLFxyXG4gICAgbWRUZW1wbGF0ZTogXCJ7e3RleHR9fSAoU291cmNlOiBbW3t7ZmlsZX19XV0pXCIsXHJcbiAgICBwZGZUZW1wbGF0ZTogXCJ7e3RleHR9fSAoU291cmNlOiBbW3t7ZmlsZX19I3BhZ2U9e3twYWdlfX1dXSlcIixcclxuICAgIHdlYlRlbXBsYXRlOiBcInt7dGV4dH19IChTb3VyY2U6IFtXZWJdKHt7dXJsfX0pKVwiXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUZXh0U29ydGVyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuICAgIHNldHRpbmdzOiBUZXh0U29ydGVyU2V0dGluZ3M7XHJcbiAgICBmbG9hdGluZ0JhcjogU29ydGluZ0Zsb2F0aW5nQmFyO1xyXG4gICAgYWN0aXZlVGFyZ2V0SGVhZGluZzogc3RyaW5nIHwgbnVsbCA9IG51bGw7IFxyXG5cclxuICAgIGFzeW5jIG9ubG9hZCgpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgVGV4dFNvcnRlclNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHJcbiAgICAgICAgdGhpcy5mbG9hdGluZ0JhciA9IG5ldyBTb3J0aW5nRmxvYXRpbmdCYXIodGhpcyk7XHJcblxyXG4gICAgICAgIC8vIDEpIEFERCBDT01NQU5EUyBGT1IgSE9US0VZU1xyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiAndG9nZ2xlLXNvcnRlci1iYXInLFxyXG4gICAgICAgICAgICBuYW1lOiAnU2hvdy9IaWRlIHNvcnRpbmcgYmFyJyxcclxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMuZmxvYXRpbmdCYXIudG9nZ2xlKCF0aGlzLnNldHRpbmdzLnNob3dGbG9hdGluZ0JhcilcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgICAgICAgaWQ6ICdzZW5kLXNtYXJ0JyxcclxuICAgICAgICAgICAgbmFtZTogJ1NlbmQgc2VsZWN0aW9uL2xpbmUgdG8gdGFyZ2V0IGhlYWRpbmcnLFxyXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5oYW5kbGVUcmFuc2Zlcignc21hcnQnKVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICAgICAgICBpZDogJ3NlbmQtY2xpcGJvYXJkJyxcclxuICAgICAgICAgICAgbmFtZTogJ1NlbmQgY2xpcGJvYXJkIHRvIHRhcmdldCBoZWFkaW5nJyxcclxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMuaGFuZGxlVHJhbnNmZXIoJ2NsaXBib2FyZCcpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFdhdGNoIGZvciBmaWxlIHJlbmFtZXMgdG8ga2VlcCB0YXJnZXQgbG9ja2VkXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoZmlsZTogVEFic3RyYWN0RmlsZSwgb2xkUGF0aDogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChvbGRQYXRoID09PSB0aGlzLnNldHRpbmdzLnRhcmdldEZpbGVQYXRoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnRhcmdldEZpbGVQYXRoID0gZmlsZS5wYXRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmxvYXRpbmdCYXIucmVmcmVzaEhlYWRpbmdzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsICgpID0+IHRoaXMuZmxvYXRpbmdCYXIucmVmcmVzaEhlYWRpbmdzKCkpKTtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsIChmaWxlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChmaWxlLnBhdGggPT09IHRoaXMuc2V0dGluZ3MudGFyZ2V0RmlsZVBhdGggfHwgZmlsZSA9PT0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mbG9hdGluZ0Jhci5yZWZyZXNoSGVhZGluZ3MoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5zaG93RmxvYXRpbmdCYXIpIHRoaXMuZmxvYXRpbmdCYXIudG9nZ2xlKHRydWUsIGZhbHNlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbnVubG9hZCgpIHtcclxuICAgICAgICB0aGlzLmZsb2F0aW5nQmFyLmNsZWFyVUkoKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7IHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpOyB9XHJcbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7IGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7IH1cclxuXHJcbiAgICAvLyAyKSBBQ1RVQUwgRk9STUFUVElORyBMT0dJQyBVU0lORyB7e3RleHR9fVxyXG4gICAgYXN5bmMgZm9ybWF0T3V0cHV0KHJhd1RleHQ6IHN0cmluZywgYWN0aXZlVmlldzogYW55KTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MudXNlQ3VzdG9tRm9ybWF0dGluZyB8fCAhYWN0aXZlVmlldykgcmV0dXJuIHJhd1RleHQ7XHJcblxyXG4gICAgICAgIGNvbnN0IHZpZXdUeXBlID0gYWN0aXZlVmlldy5nZXRWaWV3VHlwZSgpO1xyXG5cclxuICAgICAgICBpZiAoW1wid2ViLXZpZXdlclwiLCBcIndlYnZpZXdlclwiLCBcIndlYnZpZXdcIiwgXCJzdXJmZXItdmlld1wiXS5pbmNsdWRlcyh2aWV3VHlwZSkpIHtcclxuICAgICAgICAgICAgY29uc3QgdXJsID0gYWN0aXZlVmlldy5nZXRTdGF0ZSgpPy51cmwgfHwgYWN0aXZlVmlldy51cmw7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLndlYlRlbXBsYXRlXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcInt7dGV4dH19XCIsIHJhd1RleHQpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcInt7dXJsfX1cIiwgdXJsIHx8IFwiXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHZpZXdUeXBlID09PSBcInBkZlwiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBhY3RpdmVWaWV3LmZpbGU7XHJcbiAgICAgICAgICAgIGNvbnN0IGludGVybmFsVmlld2VyID0gYWN0aXZlVmlldy52aWV3ZXI/LmNoaWxkPy5wZGZWaWV3ZXI/LnBkZlZpZXdlcjtcclxuICAgICAgICAgICAgY29uc3QgcGFnZSA9IGludGVybmFsVmlld2VyPy5fbG9jYXRpb24/LnBhZ2VOdW1iZXIgfHwgaW50ZXJuYWxWaWV3ZXI/LmN1cnJlbnRQYWdlTnVtYmVyIHx8IGFjdGl2ZVZpZXcuZ2V0U3RhdGUoKT8ucGFnZSB8fCAxO1xyXG5cclxuICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MucGRmVGVtcGxhdGVcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZShcInt7dGV4dH19XCIsIHJhd1RleHQpXHJcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJ7e2ZpbGV9fVwiLCBmaWxlLnBhdGgpXHJcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJ7e3BhZ2V9fVwiLCBwYWdlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodmlld1R5cGUgPT09IFwibWFya2Rvd25cIikge1xyXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gYWN0aXZlVmlldy5maWxlO1xyXG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5tZFRlbXBsYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJ7e3RleHR9fVwiLCByYXdUZXh0KVxyXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwie3tmaWxlfX1cIiwgZmlsZS5wYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gcmF3VGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBoYW5kbGVUcmFuc2Zlcih0eXBlOiAnY2xpcGJvYXJkJyB8ICdzbWFydCcpIHtcclxuICAgICAgICBjb25zdCBhY3RpdmVMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldE1vc3RSZWNlbnRMZWFmKCk7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IGFjdGl2ZUxlYWY/LnZpZXcgYXMgYW55O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghdGhpcy5hY3RpdmVUYXJnZXRIZWFkaW5nKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyB0YXJnZXQgaGVhZGluZyBzZWxlY3RlZC5cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBleHRyYWN0ZWRUZXh0ID0gXCJcIjtcclxuXHJcbiAgICAgICAgaWYgKHR5cGUgPT09ICdjbGlwYm9hcmQnKSB7XHJcbiAgICAgICAgICAgIGV4dHJhY3RlZFRleHQgPSBhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLnJlYWRUZXh0KCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnc21hcnQnKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXdUeXBlID0gYWN0aXZlVmlldz8uZ2V0Vmlld1R5cGUoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICh2aWV3VHlwZSA9PT0gXCJwZGZcIikge1xyXG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkVGV4dCA9IGFjdGl2ZVZpZXcudmlld2VyPy5jaGlsZD8ucGRmVmlld2VyPy5wZGZWaWV3ZXI/LnRleHRTZWxlY3Rpb25NYW5hZ2VyPy5nZXRTZWxlY3RlZFRleHQoKSB8fCBcIlwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFleHRyYWN0ZWRUZXh0KSBleHRyYWN0ZWRUZXh0ID0gd2luZG93LmdldFNlbGVjdGlvbigpPy50b1N0cmluZygpIHx8IFwiXCI7XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIGVsc2UgaWYgKFtcIndlYi12aWV3ZXJcIiwgXCJ3ZWJ2aWV3ZXJcIiwgXCJ3ZWJ2aWV3XCIsIFwic3VyZmVyLXZpZXdcIl0uaW5jbHVkZXModmlld1R5cGUpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB3ZWJ2aWV3RWwgPSBhY3RpdmVWaWV3LmNvbnRlbnRFbC5xdWVyeVNlbGVjdG9yKCd3ZWJ2aWV3Jyk7XHJcbiAgICAgICAgICAgICAgICBpZiAod2Vidmlld0VsICYmIHdlYnZpZXdFbC5leGVjdXRlSmF2YVNjcmlwdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhY3RlZFRleHQgPSBhd2FpdCB3ZWJ2aWV3RWwuZXhlY3V0ZUphdmFTY3JpcHQoJ3dpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgeyBjb25zb2xlLmVycm9yKFwiV2VidmlldyBKUyBmYWlsZWRcIiwgZSk7IH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghZXh0cmFjdGVkVGV4dCB8fCAhZXh0cmFjdGVkVGV4dC50cmltKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBleHRyYWN0ZWRUZXh0ID0gYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkVGV4dCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHZpZXdUeXBlID09PSBcIm1hcmtkb3duXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzUmVhZGluZ01vZGUgPSBhY3RpdmVWaWV3LmdldE1vZGUoKSA9PT0gXCJwcmV2aWV3XCI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvciBhcyBFZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmIChpc1JlYWRpbmdNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXh0cmFjdGVkVGV4dCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKT8udG9TdHJpbmcoKSB8fCBcIlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGlvbiAmJiBzZWxlY3Rpb24udHJpbSgpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTU9ERTogTW92ZSBTZWxlY3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gYXdhaXQgdGhpcy5mb3JtYXRPdXRwdXQoc2VsZWN0aW9uLCBhY3RpdmVWaWV3KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IHRoaXMucHJvY2Vzc1RyYW5zZmVyKHRoaXMuYWN0aXZlVGFyZ2V0SGVhZGluZywgZm9ybWF0dGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTU9ERTogTW92ZSBMaW5lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVOdW0gPSBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZVRleHQgPSBlZGl0b3IuZ2V0TGluZShsaW5lTnVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVUZXh0LnRyaW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkID0gYXdhaXQgdGhpcy5mb3JtYXRPdXRwdXQobGluZVRleHQsIGFjdGl2ZVZpZXcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IHRoaXMucHJvY2Vzc1RyYW5zZmVyKHRoaXMuYWN0aXZlVGFyZ2V0SGVhZGluZywgZm9ybWF0dGVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShcIlwiLCB7IGxpbmU6IGxpbmVOdW0sIGNoOiAwIH0sIHsgbGluZTogbGluZU51bSArIDEsIGNoOiAwIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghZXh0cmFjdGVkVGV4dCB8fCAhZXh0cmFjdGVkVGV4dC50cmltKCkpIHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShcIlNlbGVjdGlvbiBpcyBlbXB0eS5cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGZpbmFsRm9ybWF0dGVkID0gYXdhaXQgdGhpcy5mb3JtYXRPdXRwdXQoZXh0cmFjdGVkVGV4dCwgYWN0aXZlVmlldyk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5wcm9jZXNzVHJhbnNmZXIodGhpcy5hY3RpdmVUYXJnZXRIZWFkaW5nLCBmaW5hbEZvcm1hdHRlZCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgcHJvY2Vzc1RyYW5zZmVyKGhlYWRpbmdOYW1lOiBzdHJpbmcsIHRleHQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICAgIGxldCB0YXJnZXRGaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnRhcmdldEZpbGVQYXRoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGYgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgodGhpcy5zZXR0aW5ncy50YXJnZXRGaWxlUGF0aCk7XHJcbiAgICAgICAgICAgIGlmIChmIGluc3RhbmNlb2YgVEZpbGUpIHRhcmdldEZpbGUgPSBmO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRhcmdldEZpbGUpIHRhcmdldEZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG5cclxuICAgICAgICBpZiAoIXRhcmdldEZpbGUgfHwgdGFyZ2V0RmlsZS5leHRlbnNpb24gIT09ICdtZCcpIHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShcIlRhcmdldCBtdXN0IGJlIGEgTWFya2Rvd24gZmlsZS5cIik7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBvcGVuRWRpdG9yOiBFZGl0b3IgfCBudWxsID0gbnVsbDtcclxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuaXRlcmF0ZUFsbExlYXZlcyhsZWFmID0+IHtcclxuICAgICAgICAgICAgaWYgKGxlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyAmJiBsZWFmLnZpZXcuZmlsZS5wYXRoID09PSB0YXJnZXRGaWxlPy5wYXRoKSB7XHJcbiAgICAgICAgICAgICAgICBvcGVuRWRpdG9yID0gbGVhZi52aWV3LmVkaXRvcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAob3BlbkVkaXRvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnNlcnRWaWFFZGl0b3Iob3BlbkVkaXRvciwgdGFyZ2V0RmlsZSwgaGVhZGluZ05hbWUsIHRleHQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zZXJ0VmlhVmF1bHRQcm9jZXNzKHRhcmdldEZpbGUsIGhlYWRpbmdOYW1lLCB0ZXh0KTtcclxuICAgIH1cclxuXHJcbiAgICBpbnNlcnRWaWFFZGl0b3IoZWRpdG9yOiBFZGl0b3IsIGZpbGU6IFRGaWxlLCBoZWFkaW5nTmFtZTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgICAgIGNvbnN0IGhlYWRpbmdzID0gY2FjaGU/LmhlYWRpbmdzIHx8IFtdO1xyXG4gICAgICAgIGNvbnN0IHRhcmdldElkeCA9IGhlYWRpbmdzLmZpbmRJbmRleChoID0+IGguaGVhZGluZyA9PT0gaGVhZGluZ05hbWUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh0YXJnZXRJZHggPT09IC0xKSB7IG5ldyBOb3RpY2UoYEhlYWRpbmcgXCIke2hlYWRpbmdOYW1lfVwiIG5vdCBmb3VuZC5gKTsgcmV0dXJuIGZhbHNlOyB9XHJcblxyXG4gICAgICAgIGNvbnN0IGlzTGFzdEhlYWRpbmcgPSB0YXJnZXRJZHggPT09IGhlYWRpbmdzLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgY29uc3QgaW5zZXJ0TGluZSA9IGlzTGFzdEhlYWRpbmcgPyBlZGl0b3IubGluZUNvdW50KCkgOiBoZWFkaW5nc1t0YXJnZXRJZHggKyAxXS5wb3NpdGlvbi5zdGFydC5saW5lO1xyXG5cclxuICAgICAgICBjb25zdCBjb250ZW50ID0gYFxcbiR7dGV4dH1cXG5gO1xyXG4gICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoY29udGVudCwgeyBsaW5lOiBpbnNlcnRMaW5lLCBjaDogMCB9KTtcclxuICAgICAgICBcclxuICAgICAgICBuZXcgTm90aWNlKGBBZGRlZCB0byBcIiR7aGVhZGluZ05hbWV9XCJgKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBpbnNlcnRWaWFWYXVsdFByb2Nlc3MoZmlsZTogVEZpbGUsIGhlYWRpbmdOYW1lOiBzdHJpbmcsIHRleHQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LnByb2Nlc3MoZmlsZSwgKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gZGF0YS5zcGxpdCgnXFxuJyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGluZ3MgPSBjYWNoZT8uaGVhZGluZ3MgfHwgW107XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRJZHggPSBoZWFkaW5ncy5maW5kSW5kZXgoaCA9PiBoLmhlYWRpbmcgPT09IGhlYWRpbmdOYW1lKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldElkeCA9PT0gLTEpIHRocm93IG5ldyBFcnJvcihcIkhlYWRpbmcgbm90IGZvdW5kXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzTGFzdEhlYWRpbmcgPSB0YXJnZXRJZHggPT09IGhlYWRpbmdzLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbnNlcnRMaW5lID0gaXNMYXN0SGVhZGluZyA/IGxpbmVzLmxlbmd0aCA6IGhlYWRpbmdzW3RhcmdldElkeCArIDFdLnBvc2l0aW9uLnN0YXJ0LmxpbmU7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGxpbmVzLnNwbGljZShpbnNlcnRMaW5lLCAwLCB0ZXh0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFNlbnQgdG8gXCIke2ZpbGUuYmFzZW5hbWV9XCJgKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGUubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SGVhZGluZ3MoZmlsZTogVEZpbGUgfCBudWxsKTogSGVhZGluZ0NhY2hlW10ge1xyXG4gICAgICAgIGlmICghZmlsZSkgcmV0dXJuIFtdO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uaGVhZGluZ3MgfHwgW107XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIFNvcnRpbmdGbG9hdGluZ0JhciB7XHJcbiAgICBwcml2YXRlIHBsdWdpbjogVGV4dFNvcnRlclBsdWdpbjtcclxuICAgIHB1YmxpYyBjb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIGRyb3Bkb3duOiBIVE1MU2VsZWN0RWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBsYWJlbDogSFRNTFNwYW5FbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIG1vdmVCdG46IEhUTUxCdXR0b25FbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBUZXh0U29ydGVyUGx1Z2luKSB7IHRoaXMucGx1Z2luID0gcGx1Z2luOyB9XHJcblxyXG4gICAgcHVibGljIGNsZWFyVUkoKSB7IHRoaXMuY29udGFpbmVyPy5yZW1vdmUoKTsgdGhpcy5jb250YWluZXIgPSBudWxsOyB9XHJcblxyXG4gICAgcHVibGljIGFzeW5jIHRvZ2dsZShzaG93OiBib29sZWFuLCBzYXZlID0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMuY2xlYXJVSSgpO1xyXG4gICAgICAgIGlmIChzaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVUkoKTtcclxuICAgICAgICAgICAgdGhpcy5yZWZyZXNoSGVhZGluZ3MoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNhdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd0Zsb2F0aW5nQmFyID0gc2hvdztcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY3JlYXRlVUkoKSB7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ3NvcnRlci1iYXInIH0pO1xyXG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb250YWluZXIuc3R5bGUsIHtcclxuICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsIHpJbmRleDogJ3ZhcigtLWxheWVyLWNvdmVyKScsXHJcbiAgICAgICAgICAgIGxlZnQ6IGAke3RoaXMucGx1Z2luLnNldHRpbmdzLmJhckxlZnR9cHhgLCB0b3A6IGAke3RoaXMucGx1Z2luLnNldHRpbmdzLmJhclRvcH1weGAsXHJcbiAgICAgICAgICAgIGJhY2tncm91bmQ6ICd2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpJywgYm9yZGVyOiAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKScsXHJcbiAgICAgICAgICAgIGJvcmRlclJhZGl1czogJzhweCcsIHBhZGRpbmc6ICc1cHggMTBweCcsIGJveFNoYWRvdzogJ3ZhcigtLXNoYWRvdy1sKScsIFxyXG4gICAgICAgICAgICBkaXNwbGF5OiAnZmxleCcsIGdhcDogJzhweCcsIGFsaWduSXRlbXM6ICdjZW50ZXInXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNyZWF0ZUJ0biA9ICh0ZXh0OiBzdHJpbmcsIGNiOiAoKSA9PiB2b2lkLCBjbHMgPSBcIlwiKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ0biA9IHRoaXMuY29udGFpbmVyIS5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0LCBjbHMgfSk7XHJcbiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4geyBlLnByZXZlbnREZWZhdWx0KCk7IGNiKCk7IH0pO1xyXG4gICAgICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGJ0bjtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjcmVhdGVCdG4oJ1x1RDgzQ1x1REZBRicsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhcmdldEZpbGVQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFyZ2V0RmlsZVBhdGggPyBudWxsIDogYWN0aXZlPy5wYXRoIHx8IG51bGw7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hIZWFkaW5ncygpO1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKHRoaXMucGx1Z2luLnNldHRpbmdzLnRhcmdldEZpbGVQYXRoID8gXCJMb2NrZWQgVGFyZ2V0IEZpbGVcIiA6IFwiVGFyZ2V0aW5nIEFjdGl2ZSBGaWxlXCIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmxhYmVsID0gdGhpcy5jb250YWluZXIuY3JlYXRlU3Bhbih7IGF0dHI6IHsgc3R5bGU6ICdmb250LXNpemU6MC44ZW07IG1heC13aWR0aDo4MHB4OyBvdmVyZmxvdzpoaWRkZW47IHRleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7IHdoaXRlLXNwYWNlOm5vd3JhcDsnIH0gfSk7XHJcbiAgICAgICAgdGhpcy5kcm9wZG93biA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZUVsKCdzZWxlY3QnKTtcclxuICAgICAgICB0aGlzLmRyb3Bkb3duLm9uY2hhbmdlID0gKCkgPT4gdGhpcy5wbHVnaW4uYWN0aXZlVGFyZ2V0SGVhZGluZyA9IHRoaXMuZHJvcGRvd24hLnZhbHVlO1xyXG5cclxuICAgICAgICB0aGlzLm1vdmVCdG4gPSBjcmVhdGVCdG4oJ1x1MjdBNCcsICgpID0+IHRoaXMucGx1Z2luLmhhbmRsZVRyYW5zZmVyKCdzbWFydCcpLCAnbW9kLWN0YScpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgICAgIGNyZWF0ZUJ0bignXHVEODNEXHVEQ0NCJywgKCkgPT4gdGhpcy5wbHVnaW4uaGFuZGxlVHJhbnNmZXIoJ2NsaXBib2FyZCcpKTtcclxuICAgICAgICBjcmVhdGVCdG4oJ1x1MDBENycsICgpID0+IHRoaXMudG9nZ2xlKGZhbHNlKSk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0dXBEcmFnKHRoaXMuY29udGFpbmVyKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVmcmVzaEhlYWRpbmdzKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5kcm9wZG93biB8fCAhdGhpcy5sYWJlbCB8fCAhdGhpcy5jb250YWluZXIgfHwgIXRoaXMubW92ZUJ0bikgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBhY3RpdmVMZWFmID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRNb3N0UmVjZW50TGVhZigpO1xyXG4gICAgICAgIGNvbnN0IHZpZXdUeXBlID0gYWN0aXZlTGVhZj8udmlldy5nZXRWaWV3VHlwZSgpO1xyXG4gICAgICAgIGNvbnN0IGlzVmFsaWRWaWV3ID0gW1wibWFya2Rvd25cIiwgXCJwZGZcIiwgXCJ3ZWItdmlld2VyXCIsIFwid2Vidmlld2VyXCIsIFwic3VyZmVyLXZpZXdcIl0uaW5jbHVkZXModmlld1R5cGUpO1xyXG5cclxuICAgICAgICBpZiAoIWlzVmFsaWRWaWV3KSB7IHRoaXMuY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IHJldHVybjsgfSBcclxuICAgICAgICBlbHNlIHsgdGhpcy5jb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsgfVxyXG5cclxuICAgICAgICBjb25zdCBpc01hcmtkb3duID0gdmlld1R5cGUgPT09IFwibWFya2Rvd25cIjtcclxuICAgICAgICBjb25zdCBpc1JlYWRpbmdNb2RlID0gaXNNYXJrZG93biAmJiAoYWN0aXZlTGVhZi52aWV3IGFzIE1hcmtkb3duVmlldykuZ2V0TW9kZSgpID09PSBcInByZXZpZXdcIjtcclxuICAgICAgICBjb25zdCBoYXNTZWxlY3Rpb24gPSBpc01hcmtkb3duICYmICFpc1JlYWRpbmdNb2RlICYmIChhY3RpdmVMZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3KS5lZGl0b3IuZ2V0U2VsZWN0aW9uKCkubGVuZ3RoID4gMDtcclxuICAgICAgICBjb25zdCBpc05vbkVkaXRhYmxlID0gW1wicGRmXCIsIFwid2ViLXZpZXdlclwiLCBcIndlYnZpZXdlclwiLCBcInN1cmZlci12aWV3XCJdLmluY2x1ZGVzKHZpZXdUeXBlKSB8fCBpc1JlYWRpbmdNb2RlIHx8IGhhc1NlbGVjdGlvbjtcclxuXHJcbiAgICAgICAgdGhpcy5tb3ZlQnRuLnNldFRleHQoaXNOb25FZGl0YWJsZSA/IFwiXHUyNzI4XCIgOiBcIlx1MjdBNFwiKTtcclxuICAgICAgICB0aGlzLm1vdmVCdG4udGl0bGUgPSBpc05vbkVkaXRhYmxlID8gXCJTZW5kIFNlbGVjdGlvblwiIDogXCJNb3ZlIEN1cnJlbnQgTGluZVwiO1xyXG5cclxuICAgICAgICBjb25zdCB0YXJnZXRQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFyZ2V0RmlsZVBhdGg7XHJcbiAgICAgICAgY29uc3QgZmlsZSA9IHRhcmdldFBhdGggPyB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRhcmdldFBhdGgpIDogdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsLnNldFRleHQoKHRhcmdldFBhdGggPyBcIlx1RDgzRFx1REQxMiBcIiA6IFwiXHVEODNEXHVEQ0M0IFwiKSArIGZpbGUuYmFzZW5hbWUpO1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50U2VsZWN0ZWQgPSB0aGlzLnBsdWdpbi5hY3RpdmVUYXJnZXRIZWFkaW5nO1xyXG4gICAgICAgICAgICBjb25zdCBoZWFkaW5ncyA9IHRoaXMucGx1Z2luLmdldEhlYWRpbmdzKGZpbGUpO1xyXG4gICAgICAgICAgICB0aGlzLmRyb3Bkb3duLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIGhlYWRpbmdzLmZvckVhY2goaCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvcHQgPSB0aGlzLmRyb3Bkb3duIS5jcmVhdGVFbCgnb3B0aW9uJywgeyB0ZXh0OiBoLmhlYWRpbmcsIHZhbHVlOiBoLmhlYWRpbmcgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaC5oZWFkaW5nID09PSBjdXJyZW50U2VsZWN0ZWQpIG9wdC5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hY3RpdmVUYXJnZXRIZWFkaW5nID0gdGhpcy5kcm9wZG93bi52YWx1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxhYmVsLnNldFRleHQoXCJObyBNRCBUYXJnZXRcIik7XHJcbiAgICAgICAgICAgIHRoaXMuZHJvcGRvd24uZW1wdHkoKTtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYWN0aXZlVGFyZ2V0SGVhZGluZyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0dXBEcmFnKGVsOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGxldCBpc0Rvd24gPSBmYWxzZSwgb2Zmc2V0ID0gWzAsIDBdO1xyXG4gICAgICAgIGNvbnN0IG9uTW91c2VEb3duID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGUudGFyZ2V0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgfHwgZS50YXJnZXQgaW5zdGFuY2VvZiBIVE1MQnV0dG9uRWxlbWVudCkgcmV0dXJuO1xyXG4gICAgICAgICAgICBpc0Rvd24gPSB0cnVlO1xyXG4gICAgICAgICAgICBvZmZzZXQgPSBbZWwub2Zmc2V0TGVmdCAtIGUuY2xpZW50WCwgZWwub2Zmc2V0VG9wIC0gZS5jbGllbnRZXTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IG9uTW91c2VNb3ZlID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFpc0Rvd24pIHJldHVybjtcclxuICAgICAgICAgICAgZWwuc3R5bGUubGVmdCA9IChlLmNsaWVudFggKyBvZmZzZXRbMF0pICsgJ3B4JztcclxuICAgICAgICAgICAgZWwuc3R5bGUudG9wID0gKGUuY2xpZW50WSArIG9mZnNldFsxXSkgKyAncHgnO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3Qgb25Nb3VzZVVwID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWlzRG93bikgcmV0dXJuO1xyXG4gICAgICAgICAgICBpc0Rvd24gPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYmFyTGVmdCA9IGVsLm9mZnNldExlZnQ7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmJhclRvcCA9IGVsLm9mZnNldFRvcDtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KGVsLCAnbW91c2Vkb3duJywgb25Nb3VzZURvd24pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQod2luZG93LCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpO1xyXG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQod2luZG93LCAnbW91c2V1cCcsIG9uTW91c2VVcCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIFRleHRTb3J0ZXJTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwbHVnaW46IFRleHRTb3J0ZXJQbHVnaW47XHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBUZXh0U29ydGVyUGx1Z2luKSB7IHN1cGVyKGFwcCwgcGx1Z2luKTsgdGhpcy5wbHVnaW4gPSBwbHVnaW47IH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdGb3JtYXR0aW5nICYgVGVtcGxhdGVzJyB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiVXNlIEN1c3RvbSBBcHBlbmRpbmcgRm9ybWF0c1wiKVxyXG4gICAgICAgICAgICAuc2V0RGVzYyhcIkFwcGx5IHRoZSB0ZW1wbGF0ZXMgYmVsb3cgdG8geW91ciB0ZXh0LiBVc2Uge3t0ZXh0fX0gZm9yIHRoZSBjb250ZW50LlwiKVxyXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHQgPT4gdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VDdXN0b21Gb3JtYXR0aW5nKS5vbkNoYW5nZShhc3luYyB2ID0+IHsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VDdXN0b21Gb3JtYXR0aW5nID0gdjsgXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTsgXHJcbiAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTWFya2Rvd24gVGVtcGxhdGVcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJWYXJpYWJsZXM6IHt7dGV4dH19LCB7e2ZpbGV9fVwiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dEFyZWEodCA9PiB0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1kVGVtcGxhdGUpLm9uQ2hhbmdlKGFzeW5jIHYgPT4geyBcclxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1kVGVtcGxhdGUgPSB2OyBcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyBcclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJQREYgVGVtcGxhdGVcIilcclxuICAgICAgICAgICAgLnNldERlc2MoXCJWYXJpYWJsZXM6IHt7dGV4dH19LCB7e2ZpbGV9fSwge3twYWdlfX1cIilcclxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKHQgPT4gdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wZGZUZW1wbGF0ZSkub25DaGFuZ2UoYXN5bmMgdiA9PiB7IFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGRmVGVtcGxhdGUgPSB2OyBcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpOyBcclxuICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoXCJXZWIgVmlld2VyIFRlbXBsYXRlXCIpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVmFyaWFibGVzOiB7e3RleHR9fSwge3t1cmx9fVwiKVxyXG4gICAgICAgICAgICAuYWRkVGV4dEFyZWEodCA9PiB0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLndlYlRlbXBsYXRlKS5vbkNoYW5nZShhc3luYyB2ID0+IHsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy53ZWJUZW1wbGF0ZSA9IHY7IFxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7IFxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICB9XHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBR087QUFhUCxJQUFNLG1CQUF1QztBQUFBLEVBQ3pDLGlCQUFpQjtBQUFBLEVBQ2pCLFNBQVM7QUFBQSxFQUNULFFBQVE7QUFBQSxFQUNSLGdCQUFnQjtBQUFBLEVBQ2hCLHFCQUFxQjtBQUFBLEVBQ3JCLFlBQVk7QUFBQSxFQUNaLGFBQWE7QUFBQSxFQUNiLGFBQWE7QUFDakI7QUFFQSxJQUFxQixtQkFBckIsY0FBOEMsdUJBQU87QUFBQSxFQUFyRDtBQUFBO0FBR0ksK0JBQXFDO0FBQUE7QUFBQSxFQUVyQyxNQUFNLFNBQVM7QUFDWCxVQUFNLEtBQUssYUFBYTtBQUN4QixTQUFLLGNBQWMsSUFBSSxxQkFBcUIsS0FBSyxLQUFLLElBQUksQ0FBQztBQUUzRCxTQUFLLGNBQWMsSUFBSSxtQkFBbUIsSUFBSTtBQUc5QyxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsTUFBTSxLQUFLLFlBQVksT0FBTyxDQUFDLEtBQUssU0FBUyxlQUFlO0FBQUEsSUFDMUUsQ0FBQztBQUVELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNLEtBQUssZUFBZSxPQUFPO0FBQUEsSUFDL0MsQ0FBQztBQUVELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNLEtBQUssZUFBZSxXQUFXO0FBQUEsSUFDbkQsQ0FBQztBQUdELFNBQUssY0FBYyxLQUFLLElBQUksTUFBTSxHQUFHLFVBQVUsQ0FBQyxNQUFxQixZQUFvQjtBQUNyRixVQUFJLFlBQVksS0FBSyxTQUFTLGdCQUFnQjtBQUMxQyxhQUFLLFNBQVMsaUJBQWlCLEtBQUs7QUFDcEMsYUFBSyxhQUFhO0FBQ2xCLGFBQUssWUFBWSxnQkFBZ0I7QUFBQSxNQUNyQztBQUFBLElBQ0osQ0FBQyxDQUFDO0FBRUYsU0FBSyxjQUFjLEtBQUssSUFBSSxVQUFVLEdBQUcsc0JBQXNCLE1BQU0sS0FBSyxZQUFZLGdCQUFnQixDQUFDLENBQUM7QUFDeEcsU0FBSyxjQUFjLEtBQUssSUFBSSxjQUFjLEdBQUcsV0FBVyxDQUFDLFNBQVM7QUFDOUQsVUFBSSxLQUFLLFNBQVMsS0FBSyxTQUFTLGtCQUFrQixTQUFTLEtBQUssSUFBSSxVQUFVLGNBQWMsR0FBRztBQUMzRixhQUFLLFlBQVksZ0JBQWdCO0FBQUEsTUFDckM7QUFBQSxJQUNKLENBQUMsQ0FBQztBQUVGLFNBQUssSUFBSSxVQUFVLGNBQWMsTUFBTTtBQUNuQyxVQUFJLEtBQUssU0FBUztBQUFpQixhQUFLLFlBQVksT0FBTyxNQUFNLEtBQUs7QUFBQSxJQUMxRSxDQUFDO0FBQUEsRUFDTDtBQUFBLEVBRUEsTUFBTSxXQUFXO0FBQ2IsU0FBSyxZQUFZLFFBQVE7QUFBQSxFQUM3QjtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQUUsU0FBSyxXQUFXLE9BQU8sT0FBTyxDQUFDLEdBQUcsa0JBQWtCLE1BQU0sS0FBSyxTQUFTLENBQUM7QUFBQSxFQUFHO0FBQUEsRUFDbkcsTUFBTSxlQUFlO0FBQUUsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQUEsRUFBRztBQUFBO0FBQUEsRUFHM0QsTUFBTSxhQUFhLFNBQWlCLFlBQWtDO0FBdEYxRTtBQXVGUSxRQUFJLENBQUMsS0FBSyxTQUFTLHVCQUF1QixDQUFDO0FBQVksYUFBTztBQUU5RCxVQUFNLFdBQVcsV0FBVyxZQUFZO0FBRXhDLFFBQUksQ0FBQyxjQUFjLGFBQWEsV0FBVyxhQUFhLEVBQUUsU0FBUyxRQUFRLEdBQUc7QUFDMUUsWUFBTSxRQUFNLGdCQUFXLFNBQVMsTUFBcEIsbUJBQXVCLFFBQU8sV0FBVztBQUNyRCxhQUFPLEtBQUssU0FBUyxZQUNoQixRQUFRLFlBQVksT0FBTyxFQUMzQixRQUFRLFdBQVcsT0FBTyxFQUFFO0FBQUEsSUFDckM7QUFFQSxRQUFJLGFBQWEsT0FBTztBQUNwQixZQUFNLE9BQU8sV0FBVztBQUN4QixZQUFNLGtCQUFpQiw0QkFBVyxXQUFYLG1CQUFtQixVQUFuQixtQkFBMEIsY0FBMUIsbUJBQXFDO0FBQzVELFlBQU0sU0FBTyxzREFBZ0IsY0FBaEIsbUJBQTJCLGdCQUFjLGlEQUFnQix3QkFBcUIsZ0JBQVcsU0FBUyxNQUFwQixtQkFBdUIsU0FBUTtBQUUxSCxVQUFJLGdCQUFnQix1QkFBTztBQUN2QixlQUFPLEtBQUssU0FBUyxZQUNoQixRQUFRLFlBQVksT0FBTyxFQUMzQixRQUFRLFlBQVksS0FBSyxJQUFJLEVBQzdCLFFBQVEsWUFBWSxLQUFLLFNBQVMsQ0FBQztBQUFBLE1BQzVDO0FBQUEsSUFDSjtBQUVBLFFBQUksYUFBYSxZQUFZO0FBQ3pCLFlBQU0sT0FBTyxXQUFXO0FBQ3hCLFVBQUksZ0JBQWdCLHVCQUFPO0FBQ3ZCLGVBQU8sS0FBSyxTQUFTLFdBQ2hCLFFBQVEsWUFBWSxPQUFPLEVBQzNCLFFBQVEsWUFBWSxLQUFLLElBQUk7QUFBQSxNQUN0QztBQUFBLElBQ0o7QUFFQSxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsTUFBTSxlQUFlLE1BQTZCO0FBM0h0RDtBQTRIUSxVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsa0JBQWtCO0FBQ3hELFVBQU0sYUFBYSx5Q0FBWTtBQUUvQixRQUFJLENBQUMsS0FBSyxxQkFBcUI7QUFDM0IsVUFBSSx1QkFBTyw2QkFBNkI7QUFDeEM7QUFBQSxJQUNKO0FBRUEsUUFBSSxnQkFBZ0I7QUFFcEIsUUFBSSxTQUFTLGFBQWE7QUFDdEIsc0JBQWdCLE1BQU0sVUFBVSxVQUFVLFNBQVM7QUFBQSxJQUN2RCxXQUFXLFNBQVMsU0FBUztBQUN6QixZQUFNLFdBQVcseUNBQVk7QUFFN0IsVUFBSSxhQUFhLE9BQU87QUFDcEIsMEJBQWdCLHdDQUFXLFdBQVgsbUJBQW1CLFVBQW5CLG1CQUEwQixjQUExQixtQkFBcUMsY0FBckMsbUJBQWdELHlCQUFoRCxtQkFBc0Usc0JBQXFCO0FBQzNHLFlBQUksQ0FBQztBQUFlLDRCQUFnQixZQUFPLGFBQWEsTUFBcEIsbUJBQXVCLGVBQWM7QUFBQSxNQUM3RSxXQUNTLENBQUMsY0FBYyxhQUFhLFdBQVcsYUFBYSxFQUFFLFNBQVMsUUFBUSxHQUFHO0FBQy9FLGNBQU0sWUFBWSxXQUFXLFVBQVUsY0FBYyxTQUFTO0FBQzlELFlBQUksYUFBYSxVQUFVLG1CQUFtQjtBQUMxQyxjQUFJO0FBQ0EsNEJBQWdCLE1BQU0sVUFBVSxrQkFBa0Isa0NBQWtDO0FBQUEsVUFDeEYsU0FBUyxHQUFQO0FBQVksb0JBQVEsTUFBTSxxQkFBcUIsQ0FBQztBQUFBLFVBQUc7QUFBQSxRQUN6RDtBQUNBLFlBQUksQ0FBQyxpQkFBaUIsQ0FBQyxjQUFjLEtBQUssR0FBRztBQUN6QywwQkFBZ0IsTUFBTSxVQUFVLFVBQVUsU0FBUztBQUFBLFFBQ3ZEO0FBQUEsTUFDSixXQUNTLGFBQWEsWUFBWTtBQUM5QixjQUFNLGdCQUFnQixXQUFXLFFBQVEsTUFBTTtBQUMvQyxjQUFNLFNBQVMsV0FBVztBQUUxQixZQUFJLGVBQWU7QUFDZiw0QkFBZ0IsWUFBTyxhQUFhLE1BQXBCLG1CQUF1QixlQUFjO0FBQUEsUUFDekQsT0FBTztBQUNILGdCQUFNLFlBQVksT0FBTyxhQUFhO0FBQ3RDLGNBQUksYUFBYSxVQUFVLEtBQUssRUFBRSxTQUFTLEdBQUc7QUFFMUMsa0JBQU0sWUFBWSxNQUFNLEtBQUssYUFBYSxXQUFXLFVBQVU7QUFDL0Qsa0JBQU0sVUFBVSxNQUFNLEtBQUssZ0JBQWdCLEtBQUsscUJBQXFCLFNBQVM7QUFDOUUsZ0JBQUk7QUFBUyxxQkFBTyxpQkFBaUIsRUFBRTtBQUN2QztBQUFBLFVBQ0osT0FBTztBQUVILGtCQUFNLFVBQVUsT0FBTyxVQUFVLEVBQUU7QUFDbkMsa0JBQU0sV0FBVyxPQUFPLFFBQVEsT0FBTztBQUN2QyxnQkFBSSxTQUFTLEtBQUssR0FBRztBQUNqQixvQkFBTSxZQUFZLE1BQU0sS0FBSyxhQUFhLFVBQVUsVUFBVTtBQUM5RCxvQkFBTSxVQUFVLE1BQU0sS0FBSyxnQkFBZ0IsS0FBSyxxQkFBcUIsU0FBUztBQUM5RSxrQkFBSSxTQUFTO0FBQ1QsdUJBQU8sYUFBYSxJQUFJLEVBQUUsTUFBTSxTQUFTLElBQUksRUFBRSxHQUFHLEVBQUUsTUFBTSxVQUFVLEdBQUcsSUFBSSxFQUFFLENBQUM7QUFBQSxjQUNsRjtBQUFBLFlBQ0o7QUFDQTtBQUFBLFVBQ0o7QUFBQSxRQUNKO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFFQSxRQUFJLENBQUMsaUJBQWlCLENBQUMsY0FBYyxLQUFLLEdBQUc7QUFDekMsVUFBSSx1QkFBTyxxQkFBcUI7QUFDaEM7QUFBQSxJQUNKO0FBRUEsVUFBTSxpQkFBaUIsTUFBTSxLQUFLLGFBQWEsZUFBZSxVQUFVO0FBQ3hFLFVBQU0sS0FBSyxnQkFBZ0IsS0FBSyxxQkFBcUIsY0FBYztBQUFBLEVBQ3ZFO0FBQUEsRUFFQSxNQUFNLGdCQUFnQixhQUFxQixNQUFnQztBQUN2RSxRQUFJLGFBQTJCO0FBQy9CLFFBQUksS0FBSyxTQUFTLGdCQUFnQjtBQUM5QixZQUFNLElBQUksS0FBSyxJQUFJLE1BQU0sc0JBQXNCLEtBQUssU0FBUyxjQUFjO0FBQzNFLFVBQUksYUFBYTtBQUFPLHFCQUFhO0FBQUEsSUFDekM7QUFDQSxRQUFJLENBQUM7QUFBWSxtQkFBYSxLQUFLLElBQUksVUFBVSxjQUFjO0FBRS9ELFFBQUksQ0FBQyxjQUFjLFdBQVcsY0FBYyxNQUFNO0FBQzlDLFVBQUksdUJBQU8saUNBQWlDO0FBQzVDLGFBQU87QUFBQSxJQUNYO0FBRUEsUUFBSSxhQUE0QjtBQUNoQyxTQUFLLElBQUksVUFBVSxpQkFBaUIsVUFBUTtBQUN4QyxVQUFJLEtBQUssZ0JBQWdCLGdDQUFnQixLQUFLLEtBQUssS0FBSyxVQUFTLHlDQUFZLE9BQU07QUFDL0UscUJBQWEsS0FBSyxLQUFLO0FBQUEsTUFDM0I7QUFBQSxJQUNKLENBQUM7QUFFRCxRQUFJLFlBQVk7QUFDWixhQUFPLEtBQUssZ0JBQWdCLFlBQVksWUFBWSxhQUFhLElBQUk7QUFBQSxJQUN6RTtBQUVBLFdBQU8sS0FBSyxzQkFBc0IsWUFBWSxhQUFhLElBQUk7QUFBQSxFQUNuRTtBQUFBLEVBRUEsZ0JBQWdCLFFBQWdCLE1BQWEsYUFBcUIsTUFBdUI7QUFDckYsVUFBTSxRQUFRLEtBQUssSUFBSSxjQUFjLGFBQWEsSUFBSTtBQUN0RCxVQUFNLFlBQVcsK0JBQU8sYUFBWSxDQUFDO0FBQ3JDLFVBQU0sWUFBWSxTQUFTLFVBQVUsT0FBSyxFQUFFLFlBQVksV0FBVztBQUVuRSxRQUFJLGNBQWMsSUFBSTtBQUFFLFVBQUksdUJBQU8sWUFBWSx5QkFBeUI7QUFBRyxhQUFPO0FBQUEsSUFBTztBQUV6RixVQUFNLGdCQUFnQixjQUFjLFNBQVMsU0FBUztBQUN0RCxVQUFNLGFBQWEsZ0JBQWdCLE9BQU8sVUFBVSxJQUFJLFNBQVMsWUFBWSxDQUFDLEVBQUUsU0FBUyxNQUFNO0FBRS9GLFVBQU0sVUFBVTtBQUFBLEVBQUs7QUFBQTtBQUNyQixXQUFPLGFBQWEsU0FBUyxFQUFFLE1BQU0sWUFBWSxJQUFJLEVBQUUsQ0FBQztBQUV4RCxRQUFJLHVCQUFPLGFBQWEsY0FBYztBQUN0QyxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRUEsTUFBTSxzQkFBc0IsTUFBYSxhQUFxQixNQUFnQztBQUMxRixRQUFJO0FBQ0EsWUFBTSxLQUFLLElBQUksTUFBTSxRQUFRLE1BQU0sQ0FBQyxTQUFTO0FBQ3pDLGNBQU0sUUFBUSxLQUFLLE1BQU0sSUFBSTtBQUM3QixjQUFNLFFBQVEsS0FBSyxJQUFJLGNBQWMsYUFBYSxJQUFJO0FBQ3RELGNBQU0sWUFBVywrQkFBTyxhQUFZLENBQUM7QUFDckMsY0FBTSxZQUFZLFNBQVMsVUFBVSxPQUFLLEVBQUUsWUFBWSxXQUFXO0FBRW5FLFlBQUksY0FBYztBQUFJLGdCQUFNLElBQUksTUFBTSxtQkFBbUI7QUFFekQsY0FBTSxnQkFBZ0IsY0FBYyxTQUFTLFNBQVM7QUFDdEQsY0FBTSxhQUFhLGdCQUFnQixNQUFNLFNBQVMsU0FBUyxZQUFZLENBQUMsRUFBRSxTQUFTLE1BQU07QUFFekYsY0FBTSxPQUFPLFlBQVksR0FBRyxJQUFJO0FBQ2hDLGVBQU8sTUFBTSxLQUFLLElBQUk7QUFBQSxNQUMxQixDQUFDO0FBQ0QsVUFBSSx1QkFBTyxZQUFZLEtBQUssV0FBVztBQUN2QyxhQUFPO0FBQUEsSUFDWCxTQUFTLEdBQVA7QUFDRSxVQUFJLHVCQUFPLEVBQUUsT0FBTztBQUNwQixhQUFPO0FBQUEsSUFDWDtBQUFBLEVBQ0o7QUFBQSxFQUVBLFlBQVksTUFBb0M7QUF0UXBEO0FBdVFRLFFBQUksQ0FBQztBQUFNLGFBQU8sQ0FBQztBQUNuQixhQUFPLFVBQUssSUFBSSxjQUFjLGFBQWEsSUFBSSxNQUF4QyxtQkFBMkMsYUFBWSxDQUFDO0FBQUEsRUFDbkU7QUFDSjtBQUVBLElBQU0scUJBQU4sTUFBeUI7QUFBQSxFQU9yQixZQUFZLFFBQTBCO0FBTHRDLFNBQU8sWUFBZ0M7QUFDdkMsU0FBUSxXQUFxQztBQUM3QyxTQUFRLFFBQWdDO0FBQ3hDLFNBQVEsVUFBb0M7QUFFSixTQUFLLFNBQVM7QUFBQSxFQUFRO0FBQUEsRUFFdkQsVUFBVTtBQXJSckI7QUFxUnVCLGVBQUssY0FBTCxtQkFBZ0I7QUFBVSxTQUFLLFlBQVk7QUFBQSxFQUFNO0FBQUEsRUFFcEUsTUFBYSxPQUFPLE1BQWUsT0FBTyxNQUFNO0FBQzVDLFNBQUssUUFBUTtBQUNiLFFBQUksTUFBTTtBQUNOLFdBQUssU0FBUztBQUNkLFdBQUssZ0JBQWdCO0FBQUEsSUFDekI7QUFDQSxRQUFJLE1BQU07QUFDTixXQUFLLE9BQU8sU0FBUyxrQkFBa0I7QUFDdkMsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ25DO0FBQUEsRUFDSjtBQUFBLEVBRVEsV0FBVztBQUNmLFNBQUssWUFBWSxLQUFLLE9BQU8sSUFBSSxVQUFVLFlBQVksVUFBVSxFQUFFLEtBQUssYUFBYSxDQUFDO0FBQ3RGLFdBQU8sT0FBTyxLQUFLLFVBQVUsT0FBTztBQUFBLE1BQ2hDLFVBQVU7QUFBQSxNQUFZLFFBQVE7QUFBQSxNQUM5QixNQUFNLEdBQUcsS0FBSyxPQUFPLFNBQVM7QUFBQSxNQUFhLEtBQUssR0FBRyxLQUFLLE9BQU8sU0FBUztBQUFBLE1BQ3hFLFlBQVk7QUFBQSxNQUE2QixRQUFRO0FBQUEsTUFDakQsY0FBYztBQUFBLE1BQU8sU0FBUztBQUFBLE1BQVksV0FBVztBQUFBLE1BQ3JELFNBQVM7QUFBQSxNQUFRLEtBQUs7QUFBQSxNQUFPLFlBQVk7QUFBQSxJQUM3QyxDQUFDO0FBRUQsVUFBTSxZQUFZLENBQUMsTUFBYyxJQUFnQixNQUFNLE9BQU87QUFDMUQsWUFBTSxNQUFNLEtBQUssVUFBVyxTQUFTLFVBQVUsRUFBRSxNQUFNLElBQUksQ0FBQztBQUM1RCxVQUFJLGlCQUFpQixhQUFhLENBQUMsTUFBTTtBQUFFLFVBQUUsZUFBZTtBQUFHLFdBQUc7QUFBQSxNQUFHLENBQUM7QUFDdEUsVUFBSSxpQkFBaUIsU0FBUyxDQUFDLE1BQU0sRUFBRSxlQUFlLENBQUM7QUFDdkQsYUFBTztBQUFBLElBQ1g7QUFFQSxjQUFVLGFBQU0sWUFBWTtBQUN4QixZQUFNLFNBQVMsS0FBSyxPQUFPLElBQUksVUFBVSxjQUFjO0FBQ3ZELFdBQUssT0FBTyxTQUFTLGlCQUFpQixLQUFLLE9BQU8sU0FBUyxpQkFBaUIsUUFBTyxpQ0FBUSxTQUFRO0FBQ25HLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFDL0IsV0FBSyxnQkFBZ0I7QUFDckIsVUFBSSx1QkFBTyxLQUFLLE9BQU8sU0FBUyxpQkFBaUIsdUJBQXVCLHVCQUF1QjtBQUFBLElBQ25HLENBQUM7QUFFRCxTQUFLLFFBQVEsS0FBSyxVQUFVLFdBQVcsRUFBRSxNQUFNLEVBQUUsT0FBTyxnR0FBZ0csRUFBRSxDQUFDO0FBQzNKLFNBQUssV0FBVyxLQUFLLFVBQVUsU0FBUyxRQUFRO0FBQ2hELFNBQUssU0FBUyxXQUFXLE1BQU0sS0FBSyxPQUFPLHNCQUFzQixLQUFLLFNBQVU7QUFFaEYsU0FBSyxVQUFVLFVBQVUsVUFBSyxNQUFNLEtBQUssT0FBTyxlQUFlLE9BQU8sR0FBRyxTQUFTO0FBQ2xGLGNBQVUsYUFBTSxNQUFNLEtBQUssT0FBTyxlQUFlLFdBQVcsQ0FBQztBQUM3RCxjQUFVLFFBQUssTUFBTSxLQUFLLE9BQU8sS0FBSyxDQUFDO0FBRXZDLFNBQUssVUFBVSxLQUFLLFNBQVM7QUFBQSxFQUNqQztBQUFBLEVBRU8sa0JBQWtCO0FBQ3JCLFFBQUksQ0FBQyxLQUFLLFlBQVksQ0FBQyxLQUFLLFNBQVMsQ0FBQyxLQUFLLGFBQWEsQ0FBQyxLQUFLO0FBQVM7QUFFdkUsVUFBTSxhQUFhLEtBQUssT0FBTyxJQUFJLFVBQVUsa0JBQWtCO0FBQy9ELFVBQU0sV0FBVyx5Q0FBWSxLQUFLO0FBQ2xDLFVBQU0sY0FBYyxDQUFDLFlBQVksT0FBTyxjQUFjLGFBQWEsYUFBYSxFQUFFLFNBQVMsUUFBUTtBQUVuRyxRQUFJLENBQUMsYUFBYTtBQUFFLFdBQUssVUFBVSxNQUFNLFVBQVU7QUFBUTtBQUFBLElBQVEsT0FDOUQ7QUFBRSxXQUFLLFVBQVUsTUFBTSxVQUFVO0FBQUEsSUFBUTtBQUU5QyxVQUFNLGFBQWEsYUFBYTtBQUNoQyxVQUFNLGdCQUFnQixjQUFlLFdBQVcsS0FBc0IsUUFBUSxNQUFNO0FBQ3BGLFVBQU0sZUFBZSxjQUFjLENBQUMsaUJBQWtCLFdBQVcsS0FBc0IsT0FBTyxhQUFhLEVBQUUsU0FBUztBQUN0SCxVQUFNLGdCQUFnQixDQUFDLE9BQU8sY0FBYyxhQUFhLGFBQWEsRUFBRSxTQUFTLFFBQVEsS0FBSyxpQkFBaUI7QUFFL0csU0FBSyxRQUFRLFFBQVEsZ0JBQWdCLFdBQU0sUUFBRztBQUM5QyxTQUFLLFFBQVEsUUFBUSxnQkFBZ0IsbUJBQW1CO0FBRXhELFVBQU0sYUFBYSxLQUFLLE9BQU8sU0FBUztBQUN4QyxVQUFNLE9BQU8sYUFBYSxLQUFLLE9BQU8sSUFBSSxNQUFNLHNCQUFzQixVQUFVLElBQUksS0FBSyxPQUFPLElBQUksVUFBVSxjQUFjO0FBRTVILFFBQUksZ0JBQWdCLHlCQUFTLEtBQUssY0FBYyxNQUFNO0FBQ2xELFdBQUssTUFBTSxTQUFTLGFBQWEsZUFBUSxnQkFBUyxLQUFLLFFBQVE7QUFDL0QsWUFBTSxrQkFBa0IsS0FBSyxPQUFPO0FBQ3BDLFlBQU0sV0FBVyxLQUFLLE9BQU8sWUFBWSxJQUFJO0FBQzdDLFdBQUssU0FBUyxNQUFNO0FBQ3BCLGVBQVMsUUFBUSxPQUFLO0FBQ2xCLGNBQU0sTUFBTSxLQUFLLFNBQVUsU0FBUyxVQUFVLEVBQUUsTUFBTSxFQUFFLFNBQVMsT0FBTyxFQUFFLFFBQVEsQ0FBQztBQUNuRixZQUFJLEVBQUUsWUFBWTtBQUFpQixjQUFJLFdBQVc7QUFBQSxNQUN0RCxDQUFDO0FBQ0QsV0FBSyxPQUFPLHNCQUFzQixLQUFLLFNBQVM7QUFBQSxJQUNwRCxPQUFPO0FBQ0gsV0FBSyxNQUFNLFFBQVEsY0FBYztBQUNqQyxXQUFLLFNBQVMsTUFBTTtBQUNwQixXQUFLLE9BQU8sc0JBQXNCO0FBQUEsSUFDdEM7QUFBQSxFQUNKO0FBQUEsRUFFUSxVQUFVLElBQWlCO0FBQy9CLFFBQUksU0FBUyxPQUFPLFNBQVMsQ0FBQyxHQUFHLENBQUM7QUFDbEMsVUFBTSxjQUFjLENBQUMsTUFBa0I7QUFDbkMsVUFBSSxFQUFFLGtCQUFrQixxQkFBcUIsRUFBRSxrQkFBa0I7QUFBbUI7QUFDcEYsZUFBUztBQUNULGVBQVMsQ0FBQyxHQUFHLGFBQWEsRUFBRSxTQUFTLEdBQUcsWUFBWSxFQUFFLE9BQU87QUFBQSxJQUNqRTtBQUNBLFVBQU0sY0FBYyxDQUFDLE1BQWtCO0FBQ25DLFVBQUksQ0FBQztBQUFRO0FBQ2IsU0FBRyxNQUFNLE9BQVEsRUFBRSxVQUFVLE9BQU8sQ0FBQyxJQUFLO0FBQzFDLFNBQUcsTUFBTSxNQUFPLEVBQUUsVUFBVSxPQUFPLENBQUMsSUFBSztBQUFBLElBQzdDO0FBQ0EsVUFBTSxZQUFZLFlBQVk7QUFDMUIsVUFBSSxDQUFDO0FBQVE7QUFDYixlQUFTO0FBQ1QsV0FBSyxPQUFPLFNBQVMsVUFBVSxHQUFHO0FBQ2xDLFdBQUssT0FBTyxTQUFTLFNBQVMsR0FBRztBQUNqQyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDbkM7QUFDQSxTQUFLLE9BQU8saUJBQWlCLElBQUksYUFBYSxXQUFXO0FBQ3pELFNBQUssT0FBTyxpQkFBaUIsUUFBUSxhQUFhLFdBQVc7QUFDN0QsU0FBSyxPQUFPLGlCQUFpQixRQUFRLFdBQVcsU0FBUztBQUFBLEVBQzdEO0FBQ0o7QUFFQSxJQUFNLHVCQUFOLGNBQW1DLGlDQUFpQjtBQUFBLEVBRWhELFlBQVksS0FBVSxRQUEwQjtBQUFFLFVBQU0sS0FBSyxNQUFNO0FBQUcsU0FBSyxTQUFTO0FBQUEsRUFBUTtBQUFBLEVBRTVGLFVBQWdCO0FBQ1osVUFBTSxFQUFFLFlBQVksSUFBSTtBQUN4QixnQkFBWSxNQUFNO0FBQ2xCLGdCQUFZLFNBQVMsTUFBTSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFFN0QsUUFBSSx3QkFBUSxXQUFXLEVBQ2xCLFFBQVEsOEJBQThCLEVBQ3RDLFFBQVEsdUVBQXVFLEVBQy9FLFVBQVUsT0FBSyxFQUFFLFNBQVMsS0FBSyxPQUFPLFNBQVMsbUJBQW1CLEVBQUUsU0FBUyxPQUFNLE1BQUs7QUFDckYsV0FBSyxPQUFPLFNBQVMsc0JBQXNCO0FBQzNDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFTixRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSxtQkFBbUIsRUFDM0IsUUFBUSwrQkFBK0IsRUFDdkMsWUFBWSxPQUFLLEVBQUUsU0FBUyxLQUFLLE9BQU8sU0FBUyxVQUFVLEVBQUUsU0FBUyxPQUFNLE1BQUs7QUFDOUUsV0FBSyxPQUFPLFNBQVMsYUFBYTtBQUNsQyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDbkMsQ0FBQyxDQUFDO0FBRU4sUUFBSSx3QkFBUSxXQUFXLEVBQ2xCLFFBQVEsY0FBYyxFQUN0QixRQUFRLHlDQUF5QyxFQUNqRCxZQUFZLE9BQUssRUFBRSxTQUFTLEtBQUssT0FBTyxTQUFTLFdBQVcsRUFBRSxTQUFTLE9BQU0sTUFBSztBQUMvRSxXQUFLLE9BQU8sU0FBUyxjQUFjO0FBQ25DLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFTixRQUFJLHdCQUFRLFdBQVcsRUFDbEIsUUFBUSxxQkFBcUIsRUFDN0IsUUFBUSw4QkFBOEIsRUFDdEMsWUFBWSxPQUFLLEVBQUUsU0FBUyxLQUFLLE9BQU8sU0FBUyxXQUFXLEVBQUUsU0FBUyxPQUFNLE1BQUs7QUFDL0UsV0FBSyxPQUFPLFNBQVMsY0FBYztBQUNuQyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDbkMsQ0FBQyxDQUFDO0FBQUEsRUFDVjtBQUNKOyIsCiAgIm5hbWVzIjogW10KfQo=
